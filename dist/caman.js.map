{"version":3,"file":"caman.js","sources":["../src/core/module.js","../src/core/util.js","../src/core/store.js","../src/core/analyze.js","../src/core/event.js","../src/core/filter.js","../src/core/logger.js","../src/core/plugin.js","../src/core/pixel.js","../src/core/io.js","../src/core/renderer.js","../src/core/blender.js","../src/core/layer.js","../src/core/caman.js","../src/lib/blenders.js","../src/core/convert.js","../src/core/calculate.js","../src/lib/filters.js","../src/lib/camera.js","../src/lib/blur.js","../src/lib/posterize.js","../src/lib/presets.js","../src/lib/stackBlur.js","../src/lib/plugins.js","../src/core/index.js"],"sourcesContent":["\nconst moduleKeywords = ['extended', 'included']\n\n/**\n * For the parts of this code adapted from http://arcturo.github.com/library/coffeescript/03_classes.html\n * below is the required copyright notice.\n * Copyright (c) 2011 Alexander MacCaw (info@eribium.org)\n * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n *\n * @export\n * @class Module\n */\nexport default class Module {\n  // Extend the base object itself like a static method\n  static extends (obj) {\n    for (let key in obj) {\n      if (moduleKeywords.indexOf === -1) {\n        this[key] = obj[key]\n      }\n    }\n    obj.extended && obj.extended.apply(this)\n    return this\n  }\n\n  // Include methods on the object prototype\n  static includes (obj) {\n    for (let key in obj) {\n      if (moduleKeywords.indexOf === -1) {\n        this.prototype[key] = obj[key]\n      }\n    }\n    obj.included && obj.included.apply(this)\n    return this\n  }\n\n  // Add methods on this prototype that point to another method\n  // on another object's prototype.\n  static delegate (...args) {\n    const target = args.pop()\n    for (let i in args) {\n      const source = args[i]\n      this.prototype[source] = target.prototype[source]\n    }\n  }\n\n  // Create an alias for a function\n  static aliasFunction (to, from) {\n    this.prototype[to] = (...args) => {\n      this.prototype[from].apply(this, args)\n    }\n  }\n\n  // Create an alias for a property\n  static aliasProperty (to, from) {\n    Object.defineProperty(this.prototype, to, {\n      get() {\n        return this[from]\n      },\n      set (val) {\n        this[from] = val\n      }\n    })\n  }\n\n  // Execute a function in the context of the object,\n  // and pass a reference to the object's prototype.\n  static included (func) {\n    func.call(this, this.prototype)\n  }\n}\n","// DOM simplifier (no jQuery dependency)\n// NodeJS compatible\nexport const $ = (sel, root = document) => {\n  if (typeof sel === 'object' || typeof exports !== 'undefined') {\n    return sel\n  }\n  return root.querySelector(sel)\n}\n\nexport function noop () {}\n\n/**\n *\n *\n * @export\n * @class Util\n */\nexport class Util {\n  static uniqid () {\n    let id = 0\n    return {\n      get () {\n        return id++\n      }\n    }\n  }\n\n  // Helper function that extends one object with all the properies of other objects\n  static extend (obj, ...src) {\n    const dest = obj\n    for (let i in src) {\n      let copy = src[i]\n      for (let prop in copy) {\n        if (copy.hasOwnProperty(prop)) {\n          dest[prop] = copy[prop]\n        }\n      }\n    }\n\n    return dest\n  }\n\n  // In order to stay true to the latest spec, RGB values must be clamped between 0 and 255. If we don't do this, weird things happen.\n  static clampRGB (val) {\n    if (val < 0) {\n      return 0\n    }\n    if (val > 255) {\n      return 255\n    }\n\n    return val\n  }\n\n  static copyAttributes (from, to, opts = {}) {\n    for (let i in from.attributes) {\n      let attr = from.attributes[i]\n      if (opts.except && opts.except.indexOf(attr.nodeName) !== -1) {\n        continue\n      }\n      to.setAttribute(attr.nodeName, attr.nodeValue)\n    }\n  }\n\n  // Support for browsers that don't know Uint8Array (such as IE9)\n  static dataArray (length = 0) {\n    if (Uint8Array) {\n      return new Uint8Array(length)\n    }\n    return new Array(length)\n  }\n}\n","/**\n * Used for storing instances of CamanInstance objects such that, when Caman() is called on an already initialized element, it returns that object instead of re-initializing.\n *\n * @export\n * @class Store\n */\nexport default class Store {\n  static items = {}\n\n  static has (search) {\n    return !!this.items[search]\n  }\n\n  static get (search) {\n    return this.items[search]\n  }\n\n  static put (name, obj) {\n    this.items[name] = obj\n  }\n\n  static execute (search, callback) {\n    setTimeout(() => {\n      callback.call(this.get(search), this.get(search))\n    }, 0)\n\n    return this.get(search)\n  }\n\n  static flush (name = false) {\n    if (name) {\n      delete this.items[name]\n    } else {\n      this.items = {}\n    }\n  }\n}\n","/**\n * Various image analysis methods\n *\n * @export\n * @class Analyze\n */\nexport default class Analyze {\n  constructor (c) {\n    this.c = c\n  }\n\n  // @return {Object} Hash of RGB channels and the occurrence of each value\n\n  /**\n   * Calculates the number of occurrences of each color value throughout the image.\n   *\n   *\n   * @returns {Object} Hash of RGB channels and the occurrences of each value\n   * @memberof Analyze\n   */\n  calculateLevels () {\n    const levels = {\n      r: {},\n      g: {},\n      b: {}\n    }\n    // Initialize all values to 0 first so there are no data gaps\n    for (let i = 0; i <= 255; i++) {\n      levels.r[i] = 0\n      levels.g[i] = 0\n      levels.b[i] = 0\n    }\n\n    // Iterate through each pixel block and increment the level counters\n    for (let i = 0, j = this.c.pixelData.length; i < j; i += 4) {\n      levels.r[this.c.pixelData[i]]++\n      levels.g[this.c.pixelData[i + 1]]++\n      levels.b[this.c.pixelData[i + 2]]++\n    }\n\n    // Normalize all of the numbers by converting them to percentages between\n    // 0 and 1.0\n    const numPixels = this.c.pixelData.length / 4\n\n    for (let i = 0; i <= 255; i++) {\n      levels.r[i] /= numPixels\n      levels.g[i] /= numPixels\n      levels.b[i] /= numPixels\n    }\n    return levels\n  }\n}\n","/**\n * Event system that can be used to register callbacks that get fired during certain times in the render process.\n *\n * @export\n * @class Event\n */\nexport default class Event {\n  static events = {}\n  // All of the supported event types\n  static types = [\n    'processStart',\n    'processComplete',\n    'renderStart',\n    'renderFinished',\n    'blockStarted',\n    'blockFinished'\n  ]\n\n  /**\n   * Trigger an event.\n   *\n   * @static\n   * @param { Caman } target Instance of Caman emitting the event.\n   * @param { String } type The event type.\n   * @param { Object } [data=null] Extra data to send with the event.\n   * @memberof Event\n   */\n  static trigger (target, type, data = null) {\n    if (this.events[type] && this.events[type].length) {\n      for (let i in this.events[type]) {\n        let event = this.events[type][i]\n        if (event.target === null || target.id === event.target.id) {\n          event.fn.call(target, data)\n        }\n      }\n    }\n  }\n\n  /**\n   * Listen for an event. Optionally bind the listen to a single instance or all instances.\n   *\n   * @static\n   * @overload listen(target, type, fn)\n   * Listen for events emitted from a particular Caman instance.\n   * @param { Caman } target The instance to listen to.\n   * @param { String } type The type of event to listen for.\n   * @param { Function } fn The function to call when the event occurs.\n   *\n   * @overload listen(type, fn)\n   * Listen for an event from all Caman instances.\n   * @param { String } type The type of event to listen for.\n   * @param { Function } fn The function to call when the event occurs.\n   * @memberof Event\n   */\n  static listen (target, type, fn) {\n    // Adjust arguments if target is omitted\n    if (typeof target === 'string') {\n      const _type = target\n      const _fn = type\n\n      target = null\n      type = _type\n\n      fn = _fn\n    }\n\n    // Validation\n    if (this.types.indexOf(type) === -1) {\n      return false\n    }\n\n    if (!this.events[type]) {\n      this.events[type] = []\n    }\n    this.events[type].push({target, fn})\n    return true\n  }\n}\n","import Caman from './caman'\n\n/**\n * Responsible for registering and storing all of the filters.\n *\n * @export\n * @class Filter\n */\nexport default class Filter {\n  // All of the different render operatives\n  static Type = {\n    Single: 1,\n    Kernel: 2,\n    LayerDequeue: 3,\n    LayerFinished: 4,\n    LoadOverlay: 5,\n    Plugin: 6\n  }\n\n  /**\n   * Registers a filter function.\n   *\n   * @static\n   * @param { String } name The name of the filter.\n   * @param { Function } filterFunc The filter function.\n   * @memberof Filter\n   */\n  static register (name, filterFunc) {\n    Caman.prototype[name] = filterFunc\n  }\n}\n","import Caman from './caman'\n/**\n * Simple console logger class that can be toggled on and off based on Caman.DEBUG\n *\n * @class Logger\n */\nclass Logger {\n  constructor () {\n    const logLevel = ['log', 'info', 'warn', 'error']\n    for (let i in logLevel) {\n      const name = logLevel[i]\n      this[name] = (...args) => {\n        if (!Caman.DEBUG) {\n          return\n        }\n        try {\n          console[name].apply(console, args)\n        } catch (e) {\n          // We're probably using IE9 or earlier\n          console[name](args)\n        }\n      }\n    }\n    this.debug = this.log\n  }\n}\n\nconst Log = new Logger()\nexport default Log\n","/**\n * Stores and registers standalone plugins\n *\n * @export\n * @class Plugin\n */\nexport default class Plugin {\n  static plugins = {}\n\n  static register (name, plugin) {\n    this.plugins[name] = plugin\n  }\n\n  static execute (context, name, args) {\n    this.plugins[name].apply(context, args)\n  }\n}\n","/**\n * Represents a single Pixel in an image.\n *\n * @export\n * @class Pixel\n */\nexport default class Pixel {\n  static coordinatesToLocation (x, y, width) {\n    return (y * width + x) * 4\n  }\n  static locationToCoordinates (loc, width) {\n    const y = Math.floor(loc / (width * 4))\n    const x = (loc % (width * 4)) / 4\n\n    return {x, y}\n  }\n\n  constructor (r = 0, g = 0, b = 0, a = 255, c = null) {\n    this.loc = 0\n    this.r = r\n    this.g = g\n    this.b = b\n    this.a = a\n    this.c = c\n  }\n\n  setContext (c) {\n    this.c = c\n  }\n\n  // Retrieves the X, Y location of the current pixel. The origin is at the bottom left corner of the image, like a normal coordinate system.\n  locationXY () {\n    if (!this.c) {\n      throw new Error('Requires a CamanJS context')\n    }\n    const y = this.c.dimensions.height - Math.floor(this.loc / (this.c.dimensions.width * 4))\n    const x = (this.loc % (this.c.dimensions.width * 4)) / 4\n\n    return {x, y}\n  }\n\n  pixelAtLocation (loc) {\n    if (!this.c) {\n      throw new Error('Requires a CamanJS context')\n    }\n\n    return new Pixel(\n      this.c.pixelData[loc],\n      this.c.pixelData[loc + 1],\n      this.c.pixelData[loc + 2],\n      this.c.pixelData[loc + 3],\n      this.c\n    )\n  }\n\n  // Returns an RGBA object for a pixel whose location is specified in relation to the current pixel.\n  getPixelRelative (horiz, vert) {\n    if (!this.c) {\n      throw new Error('Requires a CamanJS context')\n    }\n\n    // We invert the vert_offset in order to make the coordinate system non-inverted. In laymans terms: -1 means down and +1 means up.\n    const newLoc = this.loc + (this.c.dimensions.width * 4 * (vert * -1)) + (4 * horiz)\n\n    if (newLoc > this.c.pixelData.length || newLoc < 0) {\n      return new Pixel(0, 0, 0, 255, this.c)\n    }\n\n    return this.pixelAtLocation(newLoc)\n  }\n\n  // The counterpart to getPixelRelative, this updates the value of a pixel whose location is specified in relation to the current pixel.\n  static putPixelRelative (horiz, vert, rgba) {\n    if (!this.c) {\n      throw new Error('Requires a CamanJS context')\n    }\n\n    const newLoc = this.loc + (this.c.dimensions.width * 4 * (vert * -1)) + (4 * horiz)\n\n    if (newLoc > this.c.pixelData.length || newLoc < 0) {\n      return\n    }\n\n    this.c.pixelData[newLoc] = rgba.r\n    this.c.pixelData[newLoc + 1] = rgba.g\n    this.c.pixelData[newLoc + 2] = rgba.b\n    this.c.pixelData[newLoc + 3] = rgba.a\n\n    return true\n  }\n\n  // Gets an RGBA object for an arbitrary pixel in the canvas specified by absolute X, Y coordinates\n  getPixel (x, y) {\n    if (!this.c) {\n      throw new Error('Requires a CamanJS context')\n    }\n\n    const loc = this.coordinatesToLocation(x, y, this.width)\n    return this.pixelAtLocation(loc)\n  }\n\n  // Updates the pixel at the given X, Y coordinate\n  putPixel (x, y, rgba) {\n    if (!this.c) {\n      throw new Error('Requires a CamanJS context')\n    }\n\n    const loc = this.coordinatesToLocation(x, y, this.width)\n\n    this.c.pixelData[loc] = rgba.r\n    this.c.pixelData[loc + 1] = rgba.g\n    this.c.pixelData[loc + 2] = rgba.b\n    this.c.pixelData[loc + 3] = rgba.a\n  }\n\n  toString () {\n    this.toKey()\n  }\n\n  toHex (includeAlpha = false) {\n    let hex = `#${this.r.toString(16)}${this.g.toString(16)}${this.b.toString(16)}`\n\n    if (includeAlpha) {\n      hex += this.a.toString(16)\n    }\n    return hex\n  }\n}\n","import Caman from './caman'\nimport Log from './logger'\n\n/**\n * Various I/O based operations\n *\n * @export\n * @class IO\n */\nexport default class IO {\n  // Used for parsing image URLs for domain names.\n  static domainRegex = /(?:(?:http|https):\\/\\/)((?:\\w+)\\.(?:(?:\\w|\\.)+))/\n\n  /**\n   * Is the given URL remote?\n   * If a cross-origin setting is set, we assume you have CORS properly configured.\n   *\n   * @static\n   * @param { DOMObject } img The image to check.\n   * @returns { Boolean }\n   * @memberof IO\n   */\n  static isRemote (img) {\n    if (!img) {\n      return false\n    }\n    if (this.corsEnabled(img)) {\n      return false\n    }\n    return this.isURLRemote(img.src)\n  }\n\n  /**\n   * Given an image, we check to see if a CORS policy has been defined.\n   *\n   * @static\n   * @param { DOMObject } img The image to check.\n   * @returns { Boolean }\n   * @memberof IO\n   */\n  static corsEnabled (img) {\n    return img.crossOrigin && (img.crossOrigin.toLowerCase() === 'anonymous' || img.crossOrigin.toLowerCase() === 'use-credentials')\n  }\n\n  /**\n   * Does the given URL exist on a different domain than the current one?\n   * This is done by comparing the URL to `document.domain`.\n   *\n   * @static\n   * @param { String } url The URL to check.\n   * @returns { Boolean }\n   * @memberof IO\n   */\n  static isURLRemote (url) {\n    const matches = url.match(this.domainRegex)\n    return matches ? matches[1] !== document.domain : false\n  }\n\n  /**\n   * Checks to see if the URL is remote, and if there is a proxy defined\n   *\n   * @static\n   * @param { String } src The URL to check.\n   * @returns { String } The proxy URL if the image is remote. Nothing otherwise.\n   * @memberof IO\n   */\n  static remoteCheck (src) {\n    if (this.isURLRemote(src)) {\n      if (!Caman.remoteProxy.length) {\n        Log.info(`Attempting to load a remote image without a configured proxy. URL: //${src}`)\n      } else {\n        if (Caman.isURLRemote(Caman.remoteProxy)) {\n          Log.info('Cannot use a remote proxy for loading images.')\n          return\n        }\n        return this.proxyUrl(src)\n      }\n    }\n  }\n\n  /**\n   * Given a URL, get the proxy URL for it.\n   *\n   * @static\n   * @param { String } src The URL to proxy.\n   * @returns { String } The proxy URL.\n   * @memberof IO\n   */\n  static proxyUrl (src) {\n    return `${Caman.remoteProxy ? Caman.remoteProxy : ''} //${Caman.proxyParam}=//${encodeURIComponent(src)}`\n  }\n\n  /**\n   * Shortcut for using one of the bundled proxies.\n   *\n   * @static\n   * @param { String } lang String identifier for the proxy script language.\n   * @returns { String } A proxy URL.\n   * @memberof IO\n   */\n  static useProxy (lang) {\n    const langToExt = {\n      ruby: 'rb',\n      python: 'py',\n      perl: 'pl',\n      javascript: 'js'\n    }\n\n    lang = lang.toLowerCase()\n    lang = langToExt[lang] ? langToExt[lang] : lang\n\n    return `proxies/caman_proxy.${lang}`\n  }\n}\n","import Event from './event'\nimport Filter from './filter'\nimport { Util } from './util'\nimport Log from './logger'\nimport Plugin from './plugin'\nimport Pixel from './pixel'\nimport IO from './io'\n/**\n * Handles all of the various rendering methods in Caman. Most of the image modification happens here. A new Renderer object is created for every render operation.\n *\n * @export\n * @class Renderer\n */\nexport default class Renderer {\n  // The number of blocks to split the image into during the render process to simulate concurrency. This also helps the browser manage the (possibly) long running render jobs.\n  static Blocks = 4\n\n  constructor (c) {\n    this.c = c\n    this.renderQueue = []\n    this.modPixelData = null\n  }\n\n  add (job) {\n    if (!job) {\n      return\n    }\n    this.renderQueue.push(job)\n  }\n\n  // Grabs the next operation from the render queue and passes it to Renderer for execution\n  processNext () {\n    // If the queue is empty, fire the finished callback\n    if (this.renderQueue.length === 0) {\n      Event.trigger(this, 'renderFinished')\n      this.finishedFn && this.finishedFn.call(this.c)\n      return this\n    }\n    this.currentJob = this.renderQueue.shift()\n\n    switch (this.currentJob.type) {\n      case Filter.Type.LayerDequeue:\n        const layer = this.c.canvasQueue.shift()\n        this.c.executeLayer(layer)\n        this.processNext()\n        break\n      case Filter.Type.LayerFinished:\n        this.c.applyCurrentLayer()\n        this.c.popContext()\n        this.processNext()\n        break\n      case Filter.Type.LoadOverlay:\n        this.loadOverlay(this.currentJob.layer, this.currentJob.src)\n        break\n      case Filter.Type.Plugin:\n        this.executePlugin()\n        break\n      default:\n        this.executeFilter()\n    }\n  }\n\n  execute (callback) {\n    this.finishedFn = callback\n    this.modPixelData = Util.dataArray(this.c.pixelData.length)\n    this.processNext()\n  }\n\n  eachBlock (fn) {\n    // Prepare all the required render data\n    this.blocksDone = 0\n\n    const n = this.c.pixelData.length\n    const blockPixelLength = Math.floor((n / 4) / Renderer.Blocks)\n    const blockN = blockPixelLength * 4\n    const lastBlockN = blockN + ((n / 4) % Renderer.Blocks) * 4\n\n    for (let i = 0; i < Renderer.Blocks; i++) {\n      const start = i * blockN\n      const end = start + (i === Renderer.Blocks - 1 ? lastBlockN : blockN)\n      setTimeout(() => {\n        fn.call(this, i, start, end)\n      }, 0)\n    }\n  }\n\n  // The core of the image rendering, this function executes the provided filter.\n  // NOTE: this does not write the updated pixel data to the canvas. That happens when all filters are finished rendering in order to be as fast as possible.\n  executeFilter () {\n    Event.trigger(this.c, 'processStart', this.currentJob)\n\n    if (this.currentJob.type === Filter.Type.Single) {\n      this.eachBlock(this.renderBlock)\n    } else {\n      this.eachBlock(this.renderKernel)\n    }\n  }\n\n  // Executes a standalone plugin\n  executePlugin () {\n    Log.debug(`Executing plugin ${this.currentJob.plugin}`)\n    Plugin.execute(this.c, this.currentJob.plugin, this.currentJob.args)\n    Log.debug(`Plugin ${this.currentJob.plugin} finished!`)\n\n    this.processNext()\n  }\n\n  // Renders a single block of the canvas with the current filter function\n  renderBlock (bnum, start, end) {\n    Log.debug(`Block #${bnum} - Filter: ${this.currentJob.name}, Start: ${start}, End: ${end}`)\n    Event.trigger(this.c, 'blockStarted', {\n      blockNum: bnum,\n      totalBlocks: Renderer.Blocks,\n      startPixel: start,\n      endPixel: end\n    })\n\n    const pixel = new Pixel()\n    pixel.setContext(this.c)\n\n    for (let i = start; i < end; i += 4) {\n      pixel.loc = i\n\n      pixel.r = this.c.pixelData[i]\n      pixel.g = this.c.pixelData[i + 1]\n      pixel.b = this.c.pixelData[i + 2]\n      pixel.a = this.c.pixelData[i + 3]\n\n      this.currentJob.processFn(pixel)\n\n      this.c.pixelData[i] = Util.clampRGB(pixel.r)\n      this.c.pixelData[i + 1] = Util.clampRGB(pixel.g)\n      this.c.pixelData[i + 2] = Util.clampRGB(pixel.b)\n      this.c.pixelData[i + 3] = Util.clampRGB(pixel.a)\n    }\n\n    this.blockFinished(bnum)\n  }\n\n  // Applies an image kernel to the canvas\n  renderKernel (bnum, start, end) {\n    const bias = this.currentJob.bias\n    const divisor = this.currentJob.divisor\n    const n = this.c.pixelData.length\n\n    const adjust = this.currentJob.adjust\n    const adjustSize = Math.sqrt(adjust.length)\n\n    const kernel = []\n\n    Log.debug(`Rendering kernel - Filter: ${this.currentJob.name}`)\n\n    start = Math.max(start, this.c.dimensions.width * 4 * ((adjustSize - 1) / 2))\n    end = Math.min(end, n - (this.c.dimensions.width * 4 * ((adjustSize - 1) / 2)))\n\n    const builder = (adjustSize - 1) / 2\n\n    const pixel = new Pixel()\n    pixel.setContext(this.c)\n\n    for (let i = start; i < end; i += 4) {\n      pixel.loc = i\n      let builderIndex = 0\n\n      for (let j = -builder; j <= builder; j++) {\n        for (let k = builder; k >= -builder; k--) {\n          let p = pixel.getPixelRelative(j, k)\n          kernel[builderIndex * 3] = p.r\n          kernel[builderIndex * 3 + 1] = p.g\n          kernel[builderIndex * 3 + 2] = p.b\n          builderIndex++\n        }\n      }\n\n      const res = this.processKernel(adjust, kernel, divisor, bias)\n\n      this.modPixelData[i] = Util.clampRGB(res.r)\n      this.modPixelData[i + 1] = Util.clampRGB(res.g)\n      this.modPixelData[i + 2] = Util.clampRGB(res.b)\n      this.modPixelData[i + 3] = this.c.pixelData[i + 3]\n    }\n\n    this.blockFinished(bnum)\n  }\n\n  // Called when a single block is finished rendering. Once all blocks are done, we signal that this filter is finished rendering and continue to the next step.\n  blockFinished (bnum) {\n    if (bnum >= 0) {\n      Log.debug(`Block #${bnum} finished! Filter: ${this.currentJob.name}`)\n    }\n    this.blocksDone++\n\n    Event.trigger(this.c, 'blockFinished', {\n      blockNum: bnum,\n      blocksFinished: this.blocksDone,\n      totalBlocks: Renderer.Blocks\n    })\n\n    if (this.blocksDone === Renderer.Blocks) {\n      if (this.currentJob.type === Filter.Type.Kernel) {\n        for (let i = 0; i < this.c.pixelData.length; i++) {\n          this.c.pixelData[i] = this.modPixelData[i]\n        }\n      }\n\n      if (bnum >= 0) {\n        Log.debug(`Filter ${this.currentJob.name} finished!`)\n      }\n      Event.trigger(this.c, 'processComplete', this.currentJob)\n      this.processNext()\n    }\n  }\n\n  // The \"filter function\" for kernel adjustments.\n  processKernel (adjust, kernel, divisor, bias) {\n    const val = {\n      r: 0,\n      g: 0,\n      b: 0\n    }\n    for (let i = 0; i < adjust.length; i++) {\n      val.r += adjust[i] * kernel[i * 3]\n      val.g += adjust[i] * kernel[i * 3 + 1]\n      val.b += adjust[i] * kernel[i * 3 + 2]\n    }\n\n    val.r = (val.r / divisor) + bias\n    val.g = (val.g / divisor) + bias\n    val.b = (val.b / divisor) + bias\n    return val\n  }\n\n  // Loads an image onto the current canvas\n  loadOverlay (layer, src) {\n    /* eslint-disable no-undef */\n    const img = new Image()\n    img.onload = () => {\n      layer.context.drawImage(img, 0, 0, this.c.dimensions.width, this.c.dimensions.height)\n      layer.imageData = layer.context.getImageData(0, 0, this.c.dimensions.width, this.c.dimensions.height)\n      layer.pixelData = layer.imageData.data\n\n      this.c.pixelData = layer.pixelData\n\n      this.processNext()\n    }\n\n    const proxyUrl = IO.remoteCheck(src)\n    img.src = proxyUrl || src\n  }\n}\n","/**\n * Built-in layer blenders. Many of these mimic Photoshop blend modes.\n *\n * @export\n * @class Blender\n */\nexport default class Blender {\n  static blenders = {}\n  /**\n   * Registers a blender. Can be used to add your own blenders outside of the core library, if needed.\n   *\n   * @static\n   * @param { String } name Name of the blender.\n   * @param { Function } func The blender function.\n   * @memberof Blender\n   */\n  static register (name, func) {\n    this.blenders[name] = func\n  }\n\n  /**\n   * Executes a blender to combine a layer with its parent.\n   *\n   * @static\n   * @param { String } name Name of the blending function to invoke.\n   * @param { Object } rgbaLayer RGBA object of the current pixel from the layer.\n   * @param { Object } rgbaParent RGBA object of the corresponding pixel in the parent layer.\n   * @returns { Object } RGBA object representing the blended pixel.\n   * @memberof Blender\n   */\n  static execute (name, rgbaLayer, rgbaParent) {\n    return this.blenders[name](rgbaLayer, rgbaParent)\n  }\n}\n","import { $, Util } from './util'\nimport Filter from './filter'\nimport Blender from './blender'\n\n/**\n * The entire layering system for Caman resides in this file. Layers get their own canvasLayer object which is created when newLayer() is called. For extensive information regarding the specifics of how the layering system works, there is an in-depth blog post on this very topic.\n * Instead of copying the entirety of that post, I'll simply point you towards the [blog link](http://blog.meltingice.net/programming/implementing-layers-camanjs).\n * However, the gist of the layering system is that, for each layer, it creates a new canvas element and then either copies the parent layer's data or applies a solid color to the new layer. After some (optional) effects are applied, the layer is blended back into the parent canvas layer using one of many different blending algorithms.\n * You can also load an image (local or remote, with a proxy) into a canvas layer, which is useful if you want to add textures to an image.\n *\n * @export\n * @class Layer\n */\nexport default class Layer {\n  constructor (c) {\n    // Compatibility\n    this.c = c\n    this.filter = c\n\n    this.options = {\n      blendingMode: 'normal',\n      opacity: 1.0\n    }\n\n    // Each layer gets its own unique ID\n    this.layerID = Util.uniqid().get()\n\n    // Create the canvas for this layer\n    this.canvas = document.createElement('canvas')\n\n    this.canvas.width = this.c.dimensions.width\n    this.canvas.height = this.c.dimensions.height\n\n    this.context = this.canvas.getContext('2d')\n    this.context.createImageData(this.canvas.width, this.canvas.height)\n    this.imageData = this.context.getImageData(0, 0, this.canvas.width, this.canvas.height)\n    this.pixelData = this.imageData.data\n  }\n\n  // If you want to create nested layers\n  newLayer (cb) {\n    this.c.newLayer(cb)\n  }\n\n  // Sets the blending mode of this layer. The mode is the name of a blender function.\n  setBlendingMode (mode) {\n    this.options.blendingMode = mode\n    return this\n  }\n\n  // Sets the opacity of this layer. This affects how much of this layer is applied to the parent layer at render time.\n  opacity (opacity) {\n    this.options.opacity = opacity / 100\n    return this\n  }\n\n  // Copies the contents of the parent layer to this layer\n  copyParent () {\n    const parentData = this.pixelData\n    for (let i = 0; i < this.c.pixelData.length; i += 4) {\n      this.pixelData[i] = parentData[i]\n      this.pixelData[i + 1] = parentData[i + 1]\n      this.pixelData[i + 2] = parentData[i + 2]\n      this.pixelData[i + 3] = parentData[i + 3]\n    }\n    return this\n  }\n\n  // Fills this layer width a single color\n  fillColor () {\n    this.c.fillColor.apply(this.c, arguments)\n  }\n\n  // Loads and overlays an image onto this layer\n  overlayImage (image) {\n    if (typeof image === 'object') {\n      image = image.src\n    } else if (typeof image === 'string' && image[0] === '#') {\n      image = $(image).src\n    }\n\n    if (!image) {\n      return this\n    }\n\n    this.c.renderer.renderQueue.push({\n      type: Filter.Type.LoadOverlay,\n      src: image,\n      layer: this\n    })\n\n    return this\n  }\n\n  // Takes the contents of this layer and applies them to the parent layer at render time. This should never be called explicitly by the user.\n  applyToParent () {\n    const parentData = this.c.pixelStack[this.c.pixelStack.length - 1]\n    const layerData = this.c.pixelData\n\n    for (let i = 0; i < layerData.length; i += 4) {\n      const rgbaParent = {\n        r: parentData[i],\n        g: parentData[i + 1],\n        b: parentData[i + 2],\n        a: parentData[i + 3]\n      }\n      const rgbaLayer = {\n        r: layerData[i],\n        g: layerData[i + 1],\n        b: layerData[i + 2],\n        a: layerData[i + 3]\n      }\n\n      const result = Blender.execute(this.options.blendingMode, rgbaLayer, rgbaParent)\n      result.r = Util.clampRGB(result.r)\n      result.g = Util.clampRGB(result.g)\n      result.b = Util.clampRGB(result.b)\n      if (!result.a) {\n        result.a = rgbaLayer.a\n      }\n\n      parentData[i] = rgbaParent.r - ((rgbaParent.r - result.r) * (this.options.opacity * (result.a / 255)))\n      parentData[i + 1] = rgbaParent.g - ((rgbaParent.g - result.g) * (this.options.opacity * (result.a / 255)))\n      parentData[i + 2] = rgbaParent.b - ((rgbaParent.b - result.b) * (this.options.opacity * (result.a / 255)))\n    }\n  }\n}\n","import Module from './module'\nimport { $, noop, Util } from './util'\nimport Store from './store'\nimport Analyze from './analyze'\nimport Renderer from './renderer'\nimport Log from './logger'\nimport IO from './io'\nimport Event from './event'\nimport Filter from './filter'\nimport Layer from './layer'\n\n/**\n * Here it begins. Caman is defined.\n * There are many different initialization for Caman, which are described on the [Guides](http://camanjs.com/guides).\n * Initialization is tricky because we need to make sure everything we need is actually fully oaded in the DOM before proceeding. When initialized on an image, we need to make sure that the image is done loading before converting it to a canvas element and writing the pixel data. If we do this prematurely, the browser will throw a DOM Error, and chaos will ensue. In the event that we initialize Caman on a canvas element while specifying an image URL, we need to create a new image element, load the image, then continue with initialization.\n * The main goal for Caman was simplicity, so all of this is handled transparently to the end-user.\n *\n * @export\n * @class Caman\n * @extends {Module}\n */\nexport default class Caman extends Module {\n  // The current version.\n  static version = {\n    release: '1.0.0',\n    date: '6/08/2018'\n  }\n\n  // @property [Boolean] Debug mode enables console logging.\n  static DEBUG = true\n\n  // @property [Boolean] Allow reverting the canvas?\n  // If your JS process is running out of memory, disabling\n  // this could help drastically.\n  static allowRevert = true\n\n  // @property [String] Default cross-origin policy.\n  static crossOrigin = 'anonymous'\n\n  // @property [String] Set the URL of the image proxy script.\n  static remoteProxy = ''\n\n  // @proparty [String] The GET param used with the proxy script.\n  static proxyParam = 'camanProxyUrl'\n\n  // @property [Boolean] Are we in a NodeJS environment?\n  static NodeJS = typeof exports !== 'undefined'\n\n  // @property [Boolean] Are we in a wechat mini program environment?\n  static wechat = typeof exports !== 'undefined'\n\n  // @property [Boolean] Should we check the DOM for images with Caman instructions?\n  static autoload = !Caman.NodeJS\n\n  // Custom toString()\n  // @return [String] Version and release information.\n  static toString () {\n    return `Version ${Caman.version.release}, Released ${Caman.version.date}`\n  }\n\n  // Get the ID assigned to this canvas by Caman.\n  // @param [DOMObject] canvas The canvas to inspect.\n  // @return [String] The Caman ID associated with this canvas.\n  static getAttrId (canvas) {\n    if (Caman.NodeJS) {\n      return true\n    }\n    if (typeof canvas === 'string') {\n      canvas = $(canvas)\n    }\n    if (canvas && canvas.getAttribute) {\n      return canvas.getAttribute('data-caman-id')\n    }\n    return null\n  }\n\n  /**\n   * The Caman function. While technically a constructor, it was made to be called without the `new` keyword. Caman will figure it out.\n   * @param { DOMObject | String } initializer The DOM selector or DOM object to initialize.\n   * @overload Caman(initializer)\n   *   Initialize Caman without a callback.\n   *\n   * @overload Caman(initializer, callback)\n   *   Initialize Caman with a callback.\n   *   @param [Function] callback Function to call once initialization completes.\n   *\n   * @overload Caman(initializer, url)\n   *   Initialize Caman with a URL to an image and no callback.\n   *   @param [String] url URl to an image to draw to the canvas.\n   *\n   * @overload Caman(initializer, url, callback)\n   *   Initialize Caman with a canvas, URL to an image, and a callback.\n   *   @param [String] url URl to an image to draw to the canvas.\n   *   @param [Function] callback Function to call once initialization completes.\n   *\n   * @overload Caman(file)\n   *   NodeJS: Initialize Caman with a path to an image file and no callback.\n   *   @param [String, File] file File object or path to image to read.\n   *\n   * @overload Caman(file, callback)\n   *   NodeJS: Initialize Caman with a file and a callback.\n   *   @param [String, File] file File object or path to image to read.\n   *   @param [Function] callback Function to call once initialization completes.\n   * @return [Caman] Initialized Caman instance.\n   * @memberof Caman\n   */\n  constructor (...args) {\n    if (args.length === 0) {\n      throw new Error('Invalid arguments')\n    }\n    super()\n    if (this instanceof Caman) {\n      // We have to do this to avoid polluting the global scope\n      // because of how Coffeescript binds functions specified\n      // with => and the fact that Caman can be invoked as both\n      // a function and as a 'new' object.\n      this.finishInit = this.finishInit.bind(this)\n      this.imageLoaded = this.imageLoaded.bind(this)\n\n      if (!Caman.NodeJS) {\n        const id = parseInt(Caman.getAttrId(args[0]), 10)\n        let callback\n        if (typeof args[1] === 'function') {\n          callback = args[1]\n        } else if (typeof args[1] === 'function') {\n          callback = args[2]\n        } else {\n          callback = noop\n        }\n\n        if (!isNaN(id) && Store.has(id)) {\n          return Store.execute(id, callback)\n        }\n      }\n\n      // Every instance gets a unique ID. Makes it much simpler to check if two variables are the same instance.\n      this.id = Util.uniqid().get()\n      this.initializedPixelData = this.originalPixelData = null\n      this.cropCoordinates = { x: 0, y: 0 }\n      this.cropped = false\n      this.resized = false\n\n      this.pixelStack = [] // Stores the pixel layers\n      this.layerStack = [] // Stores all of the layers waiting to be rendered\n      this.canvasQueue = [] // Stores all of the canvases to be processed\n      this.currentLayer = null\n      this.scaled = false\n\n      this.analyze = new Analyze(this)\n      this.renderer = new Renderer(this)\n\n      this.domIsLoaded(() => {\n        this.parseArguments(args)\n        this.setup()\n      })\n      return this\n    } else {\n      return new Caman(...args)\n    }\n  }\n\n  /**\n   * Checks to ensure the DOM is loaded. Ensures the callback is always fired, even if the DOM is already loaded before it's invoked. The callback is also always called asynchronously.\n   *\n   * @param { Function } cb The callback function to fire when the DOM is ready.\n   * @memberof Caman\n   */\n  domIsLoaded (cb) {\n    if (Caman.NodeJS) {\n      setTimeout(() => {\n        cb.call(this)\n      }, 0)\n    } else {\n      if (document.readyState === 'complete') {\n        Log.debug('DOM initialized')\n        setTimeout(() => {\n          cb.call(this)\n        }, 0)\n      } else {\n        const listener = () => {\n          if (document.readyState === 'complete') {\n            Log.debug('DOM initialized')\n            cb.call(this)\n          }\n        }\n        document.addEventListener('readystatechange', listener, false)\n      }\n    }\n  }\n\n  /**\n   * Parses the arguments given to the Caman function, and sets the appropriate properties on this instance.\n   *\n   * @param { Array } args Array of arguments passed to Caman.\n   * @memberof Caman\n   */\n  parseArguments (args) {\n    if (args.length === 0) {\n      throw new Error('Invalid arguments given')\n    }\n\n    // Defaults\n    this.initObj = null\n    this.initType = null\n    this.imageUrl = null\n    this.callback = noop\n\n    // First argument is always our canvas/image\n    this.setInitObject(args[0])\n    if (args.length === 1) {\n      return\n    }\n\n    switch (typeof args[1]) {\n      case 'string':\n        this.imageUrl = args[1]\n        break\n      case 'function':\n        this.callback = args[1]\n        break\n    }\n\n    if (args.length === 2) {\n      return\n    }\n\n    this.callback = args[2]\n\n    if (args.length === 4) {\n      for (let key in args[4]) {\n        if (args[4].hasOwnProperty(key)) {\n          this.options[key] = args[4][key]\n        }\n      }\n    }\n  }\n\n  /**\n   * Sets the initialization object for this instance.\n   *\n   * @param { Object | String } obj The initialization argument.\n   * @memberof Caman\n   */\n  setInitObject (obj) {\n    if (Caman.NodeJS) {\n      this.initObj = obj\n      this.initType = 'node'\n      return\n    }\n    if (typeof obj === 'object') {\n      this.initObj = obj\n    } else {\n      this.initObj = $(obj)\n    }\n\n    if (!this.initObj) {\n      throw new Error('Could not find image or canvas for initialization.')\n    }\n\n    this.initType = this.initObj.nodeName.toLowerCase()\n  }\n\n  /**\n   * Begins the setup process, which differs depending on whether we're in NodeJS, or if an image or canvas object was provided.\n   *\n   * @memberof Caman\n   */\n  setup () {\n    console.log(this.initType)\n    switch (this.initType) {\n      case 'node':\n        this.initNode()\n        break\n      case 'img':\n        this.initImage()\n        break\n      case 'canvas':\n        this.initCanvas()\n        break\n    }\n  }\n\n  // Initialization function for NodeJS\n  initNode () {}\n\n  // Initialization function for the browser and image objects.\n  initImage () {\n    this.image = this.initObj\n    this.canvas = document.createElement('canvas')\n    this.context = this.canvas.getContext('2d')\n    Util.copyAttributes(this.image, this.canvas, {except: ['src']})\n\n    // Swap out image with the canvas element if the image exists in the DOM.\n    this.image.parentNode && this.image.parentNode.replaceChild(this.canvas, this.image)\n\n    this.imageAdjustments()\n    this.waitForImageLoaded()\n  }\n\n  // Initialization function for browser and canvas objects\n  // TODO:\n  initCanvas () {\n    this.canvas = this.initObj\n    console.log(this.canvas)\n    this.context = this.canvas.getContext('2d')\n\n    if (this.imageUrl) {\n      this.image = document.createElement('img')\n      this.image.src = this.imageUrl\n\n      this.imageAdjustments()\n      this.waitForImageLoaded()\n    } else {\n      this.finishInit()\n    }\n  }\n\n  /**\n   * Automatically check for a HiDPI capable screen and swap out the image if possible.\n   * Also checks the image URL to see if it's a cross-domain request, and attempt to proxy the image. If a cross-origin type is configured, the proxy will be ignored.\n   *\n   * @memberof Caman\n   */\n  imageAdjustments () {\n    if (IO.isRemote(this.image)) {\n      this.image.src = IO.proxyUrl(this.image.src)\n      Log.debug(`Remote image detected, using URL = ${this.image.src}`)\n    }\n  }\n\n  // Utility function that fires {Caman#imageLoaded} once the image is finished loading.\n  waitForImageLoaded () {\n    if (this.isImageLoaded()) {\n      this.imageLoaded()\n    } else {\n      this.image.onload = this.imageLoaded\n    }\n  }\n\n  /**\n   * Checks if the given image is finished loading.\n   * @returns { Boolean } Is the image loaded?\n   * @memberof Caman\n   */\n  isImageLoaded () {\n    if (!this.image.complete) {\n      return false\n    }\n    if (this.image.naturalWidth && this.image.naturalWidth === 0) {\n      return false\n    }\n    return true\n  }\n\n  /**\n   * Internet Explorer has issues figuring out image dimensions when they aren't explicitly defined, apparently. We check the normal width/height properties first, but fall back to natural sizes if they are 0.\n   * @returns { Number } Width of the initialization image.\n   * @memberof Caman\n   */\n  imageWidth () {\n    return this.image.width || this.image.naturalWidth\n  }\n\n  /**\n   * @see Caman#imageWidth\n   *\n   * @returns { Number } Height of the initialization image.\n   * @memberof Caman\n   */\n  imageHeight () {\n    return this.image.height || this.image.naturalHeight\n  }\n\n  /**\n   * Function that is called once the initialization image is finished loading.\n   * We make sure that the canvas dimensions are properly set here.\n   *\n   * @memberof Caman\n   */\n  imageLoaded () {\n    Log.debug(`Image loaded. Width = ${this.imageWidth()}, Height = ${this.imageHeight()}`)\n\n    this.canvas.width = this.imageWidth()\n    this.canvas.height = this.imageHeight()\n\n    this.finishInit()\n  }\n\n  /**\n   * Final step of initialization. We finish setting up our canvas element, and we draw the image to the canvas (if applicable).\n   *\n   * @memberof Caman\n   */\n  finishInit () {\n    if (!this.context) {\n      this.context = this.canvas.getContext('2d')\n    }\n\n    this.originalWidth = this.preScaledWidth = this.width = this.canvas.width\n    this.originalHeight = this.preScaledHeight = this.height = this.canvas.height\n\n    if (!this.hasId()) {\n      this.assignId()\n    }\n\n    if (this.image) {\n      this.context.drawImage(this.image, 0, 0, this.imageWidth(), this.imageHeight(), 0, 0, this.preScaledWidth, this.preScaledHeight)\n    }\n\n    this.imageData = this.context.getImageData(0, 0, this.canvas.width, this.canvas.height)\n    this.pixelData = this.imageData.data\n\n    if (Caman.allowRevert) {\n      this.initializedPixelData = Util.dataArray(this.pixelData.length)\n      this.originalPixelData = Util.dataArray(this.pixelData.length)\n\n      for (let i = 0; i < this.pixelData.length; i++) {\n        let pixel = this.pixelData[i]\n        this.initializedPixelData[i] = pixel\n        this.originalPixelData[i] = pixel\n      }\n    }\n\n    this.dimensions = {\n      width: this.canvas.width,\n      height: this.canvas.height\n    }\n\n    if (!Caman.NodeJS) {\n      Store.put(this.id, this)\n    }\n\n    this.callback(this)\n\n    // Reset the callback so re-initialization doesn't trigger it again.\n    this.callback = noop\n  }\n\n  /**\n   * If you have a separate context reference to this canvas outside of CamanJS and you make a change to the canvas outside of CamanJS, you will have to call this function to update our context reference to include those changes.\n   *\n   * @memberof Caman\n   */\n  reloadCanvasData () {\n    this.imageData = this.context.getImageData(0, 0, this.canvas.width, this.canvas.height)\n    this.pixelData = this.imageData.data\n  }\n\n  /**\n   * Reset the canvas pixels to the original state at initialization.\n   *\n   * @memberof Caman\n   */\n  resetOriginalPixelData () {\n    if (!Caman.allowRevert) {\n      throw new Error('Revert disabled')\n    }\n\n    this.originalPixelData = Util.dataArray(this.pixelData.length)\n    for (let i = 0; i < this.pixelData.length; i++) {\n      let pixel = this.pixelData[i]\n      this.originalPixelData[i] = pixel\n    }\n  }\n\n  /**\n   * Does this instance have an ID assigned?\n   * @returns { Boolean } Existance of an ID.\n   * @memberof Caman\n   */\n  hasId () {\n    return !!Caman.getAttrId(this.canvas)\n  }\n  /**\n   * Assign a unique ID to this instance.\n   *\n   * @memberof Caman\n   */\n  assignId () {\n    if (Caman.NodeJS || this.canvas.getAttribute('data-caman-id')) {\n      return\n    }\n    this.canvas.setAttribute('data-caman-id', this.id)\n  }\n\n  /**\n   * Replaces the current canvas with a new one, and properly updates all of the applicable references for this instance.\n   *\n   * @param { DOMObject } newCanvas The canvas to swap into this instance.\n   * @memberof Caman\n   */\n  replaceCanvas (newCanvas) {\n    const oldCanvas = this.canvas\n    this.canvas = newCanvas\n    this.context = this.canvas.getContext('2d')\n\n    if (!Caman.NodeJS) {\n      oldCanvas.parentNode.replaceChild(this.canvas, oldCanvas)\n    }\n\n    this.width = this.canvas.width\n    this.height = this.canvas.height\n\n    this.reloadCanvasData()\n\n    this.dimensions = {\n      width: this.canvas.width,\n      height: this.canvas.height\n    }\n  }\n\n  /**\n   * Begins the rendering process. This will execute all of the filter functions called either since initialization or the previous render.\n   *\n   * @param { Function } [callback=noop] Function to call when rendering is finished.\n   * @memberof Caman\n   */\n  render (callback = noop) {\n    Event.trigger(this, 'renderStart')\n\n    this.renderer.execute(() => {\n      this.context.putImageData(this.imageData, 0, 0)\n      callback.call(this)\n    })\n  }\n\n  /**\n   * Reverts the canvas back to it's original state while\n  # maintaining any cropped or resized dimensions.\n   *\n   * @param { Boolean } [updateContext=true] Should we apply the reverted pixel data to the canvas context thus triggering a re-render by the browser?\n   * @memberof Caman\n   */\n  revert (updateContext = true) {\n    if (!Caman.allowRevert) {\n      throw new Error('Revert disabled')\n    }\n\n    const originalVisiblePixels = this.originalVisiblePixels()\n    for (let i = 0, j = originalVisiblePixels.length; i < j; i++) {\n      let pixel = originalVisiblePixels[i]\n      this.pixelData[i] = pixel\n    }\n\n    if (updateContext) {\n      this.context.putImageData(this.imageData, 0, 0)\n    }\n  }\n\n  /**\n   * Completely resets the canvas back to it's original state.\n   * Any size adjustments will also be reset.\n   *\n   * @memberof Caman\n   */\n  reset () {\n    const canvas = document.createElement('canvas')\n    Util.copyAttributes(this.canvas, canvas)\n\n    canvas.width = this.originalWidth\n    canvas.height = this.originalHeight\n\n    const ctx = canvas.getContext('2d')\n    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height)\n    const pixelData = imageData.data\n\n    for (let i = 0; i < this.initializedPixelData.length; i++) {\n      let pixel = this.initializedPixelData[i]\n      pixelData[i] = pixel\n    }\n\n    ctx.putImageData(imageData, 0, 0)\n\n    this.cropCoordinates = {\n      x: 0,\n      y: 0\n    }\n    this.resized = false\n    this.replaceCanvas(canvas)\n  }\n\n  /**\n   * Returns the original pixel data while maintaining any cropping or resizing that may have occurred.\n   * **Warning**: this is currently in beta status.\n   * @returns { Array } Original pixel values still visible after cropping or resizing.\n   * @memberof Caman\n   */\n  // TODO:\n  originalVisiblePixels () {\n    if (!Caman.allowRevert) {\n      throw new Error('Revert disabled')\n    }\n\n    const pixels = []\n    return pixels\n  }\n\n  /**\n   * Pushes the filter callback that modifies the RGBA object into the\n  # render queue.\n   *\n   * @param { String } name Name of the filter function.\n   * @param { Function } processFn  The Filter function.\n   * @returns { Caman }\n   * @memberof Caman\n   */\n  process (name, processFn) {\n    this.renderer.add({\n      type: Filter.Type.Single,\n      name: name,\n      processFn: processFn\n    })\n    return this\n  }\n\n  /**\n   * Pushes the kernel into the render queue.\n   *\n   * @param { String } name The name of the kernel.\n   * @param { Array } adjust The convolution kernel represented as a 1D array.\n   * @param { Number } [divisor=null] The divisor for the convolution.\n   * @param {number} [bias=0] The bias for the convolution.\n   * @returns { Caman }\n   * @memberof Caman\n   */\n  processKernel (name, adjust, divisor = null, bias = 0) {\n    if (!divisor) {\n      divisor = 0\n      for (let i = 0; i <= adjust.length; i++) {\n        divisor += adjust[i]\n      }\n    }\n\n    this.renderer.add({\n      type: Filter.Type.Kernel,\n      name,\n      adjust,\n      divisor,\n      bias\n    })\n\n    return this\n  }\n\n  /**\n   * Adds a standalone plugin into the render queue.\n   *\n   * @param { String } plugin Name of the plugin.\n   * @param { Array } args Array of arguments to pass to the plugin.\n   * @returns { Caman }\n   * @memberof Caman\n   */\n  processPlugin (plugin, args) {\n    this.renderer.add({\n      type: Filter.Type.Plugin,\n      plugin,\n      args\n    })\n\n    return this\n  }\n\n  /**\n   * Pushes a new layer operation into the render queue and calls the layer\n  # callback.\n   *\n   * @param { Function } callback  Function that is executed within the context of the layer.\n   * All filter and adjustment functions for the layer will be executed inside of this function.\n   * @returns { Caman }\n   * @memberof Caman\n   */\n  newLayer (callback) {\n    const layer = new Layer(this)\n    this.canvasQueue.push(layer)\n    this.renderer.add({\n      type: Filter.Type.LayerDequeue\n    })\n\n    callback.call(layer)\n\n    this.renderer.add({\n      type: Filter.Type.LayerFinished\n    })\n    return this\n  }\n\n  /**\n   * Pushes the layer context and moves to the next operation.\n   *\n   * @param { Layer } layer The layer to execute.\n   * @memberof Caman\n   */\n  executeLayer (layer) {\n    this.pushContext(layer)\n  }\n\n  /**\n   * Set all of the relevant data to the new layer.\n   *\n   * @param { Layer } layer The layer whose context we want to switch to.\n   * @memberof Caman\n   */\n  pushContext (layer) {\n    this.layerStack.push(this.currentLayer)\n    this.pixelStack.push(this.pixelData)\n    this.currentLayer = layer\n    this.pixelData = layer.pixelData\n  }\n\n  // Restore the previous layer context.\n  popContext () {\n    this.pixelData = this.pixelStack.pop()\n    this.currentLayer = this.layerStack.pop()\n  }\n\n  // Applies the current layer to its parent layer.\n  applyCurrentLayer () {\n    this.currentLayer.applyToParent()\n  }\n\n  /*\n   * Grabs the canvas data, encodes it to Base64, then sets the browser location to the encoded data so that the user will be prompted to download it.\n   * If we're in NodeJS, then we can save the image to disk.\n   * @see Caman\n   */\n  save () {\n    if (exports) {\n      this.nodeSave.apply(this, arguments)\n    } else {\n      this.browserSave.apply(this, arguments)\n    }\n  }\n\n  browserSave (type = 'png') {\n    type = type.toLowerCase()\n    // Force download (its a bit hackish)\n    const image = this.toBase64(type).replace(`image/${type}`, 'image/octet-stream')\n    document.location.href = image\n  }\n\n  // nodeSave (file, overwrite = true, callback = null) {\n  //   try {\n  //     const stats = fs.statSync(file)\n  //     if (stats.isFile() && !overwrite) {\n  //       return false\n  //     }\n  //   } catch (e) {\n  //     Log.debug(`Creating output file ${file}`)\n  //   }\n\n  //   fs.writeFile(file, this.canvas.toBuffer(), (err) => {\n  //     Log.debug(`Finished writing to ${file}`)\n  //     if (callback) {\n  //       callback.call(this, err)\n  //     }\n  //   })\n  // }\n\n  /*\n   * Takes the current canvas data, converts it to Base64, then sets it as the source of a new Image object and returns it.\n   */\n  toImage (type) {\n    /* eslint-disable no-undef */\n    const img = new Image()\n    img.src = this.toBase64(type)\n    img.width = this.dimensions.width\n    img.height = this.dimensions.height\n\n    if (window.devicePixelRatio) {\n      img.width /= window.devicePixelRatio\n      img.height /= window.devicePixelRatio\n    }\n    return img\n  }\n\n  /*\n  * Base64 encodes the current canvas\n  */\n  toBase64 (type = 'png') {\n    type = type.toLowerCase()\n    return this.canvas.toDataURL(`image/${type}`)\n  }\n}\n","/**\n *\n *\n * @export\n * @param {*} Blender\n */\nexport default function registerBlender(Blender) {\n  // Directly apply the child layer's pixels to the parent layer with no special changes\n  Blender.register('normal', (rgbaLayer, rgbaParent) => {\n    return {\n      r: rgbaLayer.r,\n      g: rgbaLayer.g,\n      b: rgbaLayer.b\n    }\n  })\n\n  // Apply the child to the parent by multiplying the color values. This generally creates contrast.\n  Blender.register('multiply', (rgbaLayer, rgbaParent) => {\n    return {\n      r: (rgbaLayer.r * rgbaParent.r) / 255,\n      g: (rgbaLayer.g * rgbaParent.g) / 255,\n      b: (rgbaLayer.b * rgbaParent.b) / 255\n    }\n  })\n\n  Blender.register('screen', (rgbaLayer, rgbaParent) => {\n    return {\n      r: 255 - (((255 - rgbaLayer.r) * (255 - rgbaParent.r)) / 255),\n      g: 255 - (((255 - rgbaLayer.g) * (255 - rgbaParent.g)) / 255),\n      b: 255 - (((255 - rgbaLayer.b) * (255 - rgbaParent.b)) / 255)\n    }\n  })\n\n  Blender.register('overlay', (rgbaLayer, rgbaParent) => {\n    const result = {}\n    result.r = rgbaParent.r > 128 ? 255 - 2 * (255 - rgbaLayer.r) * (255 - rgbaParent.r) / 255 : (rgbaParent.r * rgbaLayer.r * 2) / 255\n    result.g = rgbaParent.g > 128 ? 255 - 2 * (255 - rgbaLayer.g) * (255 - rgbaParent.g) / 255 : (rgbaParent.g * rgbaLayer.g * 2) / 255\n    result.b = rgbaParent.b > 128 ? 255 - 2 * (255 - rgbaLayer.b) * (255 - rgbaParent.b) / 255 : (rgbaParent.b * rgbaLayer.b * 2) / 255\n\n    return result\n  })\n\n  Blender.register('difference', (rgbaLayer, rgbaParent) => {\n    return {\n      r: rgbaLayer.r - rgbaParent.r,\n      g: rgbaLayer.g - rgbaParent.g,\n      b: rgbaLayer.b - rgbaParent.b\n    }\n  })\n\n  Blender.register('addition', (rgbaLayer, rgbaParent) => {\n    return {\n      r: rgbaParent.r + rgbaLayer.r,\n      g: rgbaParent.g + rgbaLayer.g,\n      b: rgbaParent.b + rgbaLayer.b\n    }\n  })\n\n  Blender.register('exclusion', (rgbaLayer, rgbaParent) => {\n    return {\n      r: 128 - 2 * (rgbaParent.r - 128) * (rgbaLayer.r - 128) / 255,\n      g: 128 - 2 * (rgbaParent.g - 128) * (rgbaLayer.g - 128) / 255,\n      b: 128 - 2 * (rgbaParent.b - 128) * (rgbaLayer.b - 128) / 255\n    }\n  })\n\n  Blender.register('softLight', (rgbaLayer, rgbaParent) => {\n    const result = {}\n\n    result.r = rgbaParent.r > 128 ? 255 - ((255 - rgbaParent.r) * (255 - (rgbaLayer.r - 128))) / 255 : (rgbaParent.r * (rgbaLayer.r + 128)) / 255\n\n    result.g = rgbaParent.g > 128 ? 255 - ((255 - rgbaParent.g) * (255 - (rgbaLayer.g - 128))) / 255 : (rgbaParent.g * (rgbaLayer.g + 128)) / 255\n\n    result.b = rgbaParent.b > 128 ? 255 - ((255 - rgbaParent.b) * (255 - (rgbaLayer.b - 128))) / 255 : (rgbaParent.b * (rgbaLayer.b + 128)) / 255\n\n    return result\n  })\n\n  Blender.register('lighten', (rgbaLayer, rgbaParent) => {\n    return {\n      r: rgbaParent.r > rgbaLayer.r ? rgbaParent.r : rgbaLayer.r,\n      g: rgbaParent.g > rgbaLayer.g ? rgbaParent.g : rgbaLayer.g,\n      b: rgbaParent.b > rgbaLayer.b ? rgbaParent.b : rgbaLayer.b\n    }\n  })\n\n  Blender.register('darken', (rgbaLayer, rgbaParent) => {\n    return {\n      r: rgbaParent.r > rgbaLayer.r ? rgbaLayer.r : rgbaParent.r,\n      g: rgbaParent.g > rgbaLayer.g ? rgbaLayer.g : rgbaParent.g,\n      b: rgbaParent.b > rgbaLayer.b ? rgbaLayer.b : rgbaParent.b\n    }\n  })\n}\n","/**\n * Tons of color conversion utility functions.\n *\n * @export\n * @class Convert\n */\nexport default class Convert {\n  /**\n   * Converts the hex representation of a color to RGB values.\n   * Hex value can optionally start with the hash (#).\n   *\n   * @static\n   * @param { String } hex The colors hex value\n   * @returns { Object } The RGB representation\n   * @memberof Convert\n   */\n  static hexToRGB (hex) {\n    if (hex.charAt(0) === '#') {\n      hex = hex.substr(1)\n    }\n    const r = parseInt(hex.substr(0, 2), 16)\n    const g = parseInt(hex.substr(2, 2), 16)\n    const b = parseInt(hex.substr(4, 2), 16)\n    return { r, g, b }\n  }\n\n  /**\n   * Converts an RGB color to HSL.\n   * Assumes r, g, and b are in the set [0, 255] and\n   * returns h, s, and l in the set [0, 1].\n   *\n   * @static\n   * @param { Number } r Red channel\n   * @param { Number } g Green channel\n   * @param { Number } b Blue channel\n   * @return { Array } The HSL representation\n   * @memberof Convert\n   */\n  static rgbToHSL (r, g, b) {\n    if (typeof r === 'object') {\n      g = r.g\n      b = r.b\n      r = r.r\n    }\n\n    r /= 255\n    g /= 255\n    b /= 255\n\n    const max = Math.max(r, g, b)\n    const min = Math.min(r, g, b)\n    const l = (max + min) / 2\n    let h, s\n    if (max === min) {\n      h = s = 0\n    } else {\n      const d = max - min\n      s = l > 0.5 ? d / (2 - max - min) : d / (max + min)\n\n      if (max === r) {\n        h = (g - b) / d + g < b ? 6 : 0\n      } else if (max === g) {\n        h = (b - r) / d + 2\n      } else if (max === b) {\n        h = (r - g) / d + 4\n      }\n\n      h /= 6\n    }\n    return {h, s, l}\n  }\n\n  /**\n   * onverts an HSL color value to RGB. Conversion formula adapted from http://en.wikipedia.org/wiki/HSL_color_space.\n   * Assumes h, s, and l are contained in the set [0, 1] and returns r, g, and b in the set [0, 255].\n   *\n   * @static\n   * @param { Number } h The hue\n   * @param { Number } s The saturation\n   * @param { Number } l The lightness\n   * @returns { Object } The RGB representation\n   * @memberof Convert\n   */\n  static hslToRGB (h, s, l) {\n    let r, g, b, p, q\n    if (typeof h === 'object') {\n      s = h.s\n      l = h.l\n      h = h.h\n    }\n    if (s === 0) {\n      r = g = b = l\n    } else {\n      q = l < 0.5 ? l * (1 + s) : l + s - l * s\n      p = 2 * l - q\n\n      r = this.hueToRGB(p, q, h + 1 / 3)\n      g = this.hueToRGB(p, q, h)\n      b = this.hueToRGB(p, q, h - 1 / 3)\n    }\n    return {\n      r: r * 255,\n      g: g * 255,\n      b: b * 255\n    }\n  }\n\n  /**\n   * Converts from the hue color space back to RGB.\n   *\n   * @static\n   * @param { Number } p\n   * @param { Number } q\n   * @param { Number } t\n   * @returns { Number } RGB value\n   * @memberof Convert\n   */\n  static hueToRGB (p, q, t) {\n    if (t < 0) {\n      t += 1\n    }\n    if (t > 1) {\n      t -= 1\n    }\n    if (t < 1 / 6) {\n      return p + (q - p) * 6 * t\n    }\n    if (t < 1 / 2) {\n      return q\n    }\n    if (t < 2 / 3) {\n      return p + (q - p) * (2 / 3 - t) * 6\n    }\n    return p\n  }\n\n  /**\n   * Converts an RGB color value to HSV. Conversion formula adapted from {http://en.wikipedia.org/wiki/HSV_color_space}.\n   * Assumes r, g, and b are contained in the set [0, 255] and returns h, s, and v in the set [0, 1].\n   *\n   * @static\n   * @param {*} r The red color value\n   * @param {*} g The green color value\n   * @param {*} b The blue color value\n   * @returns { Object } The HSV representation\n   * @memberof Convert\n   */\n  static rgbToHSV (r, g, b) {\n    r /= 255\n    g /= 255\n    b /= 255\n\n    const max = Math.max(r, g, b)\n    const min = Math.min(r, g, b)\n    const v = max\n    const d = max - min\n\n    const s = max === 0 ? 0 : d / max\n    let h\n    if (max === min) {\n      h = 0\n    } else {\n      if (max === r) {\n        h = (g - b) / d + g < b ? 6 : 0\n      } else if (max === g) {\n        h = (b - r) / d + 2\n      } else if (max === b) {\n        h = (r - g) / d + 4\n      }\n      h /= 6\n    }\n\n    return {h, s, v}\n  }\n\n  /**\n   * Converts an HSV color value to RGB. Conversion formula adapted from http://en.wikipedia.org/wiki/HSV_color_space.\n   * Assumes h, s, and v are contained in the set [0, 1] and returns r, g, and b in the set [0, 255].\n   *\n   * @static\n   * @param { Number } h The hue\n   * @param { Number } s The saturation\n   * @param { Number } v The value\n   * @returns { Object } The RGB representation\n   * @memberof Convert\n   */\n  static hsvToRGB (h, s, v) {\n    const i = Math.floor(h * 6)\n    const f = h * 6 - i\n    const p = v * (1 - s)\n    const q = v * (1 - f * s)\n    const t = v * (1 - (1 - f) * s)\n\n    let r, g, b\n    switch (i % 6) {\n      case 0:\n        r = v\n        g = t\n        b = p\n        break\n      case 1:\n        r = q\n        g = v\n        b = p\n        break\n      case 2:\n        r = p\n        g = v\n        b = t\n        break\n      case 3:\n        r = p\n        g = q\n        b = v\n        break\n      case 4:\n        r = t\n        g = p\n        b = v\n        break\n      case 5:\n        r = v\n        g = p\n        b = q\n        break\n    }\n\n    return {\n      r: Math.floor(r * 255),\n      g: Math.floor(g * 255),\n      b: Math.floor(b * 255)\n    }\n  }\n\n  /**\n   * Converts a RGB color value to the XYZ color space. Formulas are based on http://en.wikipedia.org/wiki/SRGB assuming that RGB values are sRGB.\n   * Assumes r, g, and b are contained in the set [0, 255] and returns x, y, and z.\n   *\n   * @static\n   * @param { Number } r The red color value\n   * @param { Number } g The green color value\n   * @param { Number } b The blue color value\n   * @returns { Object } The XYZ representation\n   * @memberof Convert\n   */\n  static rgbToXYZ (r, g, b) {\n    r /= 255\n    g /= 255\n    b /= 255\n\n    if (r > 0.04045) {\n      r = Math.pow((r + 0.055) / 1.055, 2.4)\n    } else {\n      r /= 12.92\n    }\n\n    if (g > 0.04045) {\n      g = Math.pow((g + 0.055) / 1.055, 2.4)\n    } else {\n      g /= 12.92\n    }\n\n    if (b > 0.04045) {\n      b = Math.pow((b + 0.055) / 1.055, 2.4)\n    } else {\n      b /= 12.92\n    }\n\n    const x = r * 0.4124 + g * 0.3576 + b * 0.1805\n    const y = r * 0.2126 + g * 0.7152 + b * 0.0722\n    const z = r * 0.0193 + g * 0.1192 + b * 0.9505\n\n    return {\n      x: x * 100,\n      y: y * 100,\n      z: z * 100\n    }\n  }\n\n  /**\n   * Converts a XYZ color value to the sRGB color space. Formulas are based on http://en.wikipedia.org/wiki/SRGB and the resulting RGB value will be in the sRGB color space.\n   * Assumes x, y and z values are whatever they are and returns r, g and b in the set [0, 255].\n   *\n   * @static\n   * @param { Number } x The X value\n   * @param { Number } y The Y value\n   * @param { Number } z The Z value\n   * @returns { Object } The RGB representation\n   * @memberof Convert\n   */\n  static xyzToRGB (x, y, z) {\n    x /= 100\n    y /= 100\n    z /= 100\n\n    let r = (3.2406 * x) + (-1.5372 * y) + (-0.4986 * z)\n    let g = (-0.9689 * x) + (1.8758 * y) + (0.0415 * z)\n    let b = (0.0557 * x) + (-0.2040 * y) + (1.0570 * z)\n\n    if (r > 0.0031308) {\n      r = (1.055 * Math.pow(r, 0.4166666667)) - 0.055\n    } else {\n      r *= 12.92\n    }\n\n    if (g > 0.0031308) {\n      g = (1.055 * Math.pow(g, 0.4166666667)) - 0.055\n    } else {\n      g *= 12.92\n    }\n\n    if (b > 0.0031308) {\n      b = (1.055 * Math.pow(b, 0.4166666667)) - 0.055\n    } else {\n      b *= 12.92\n    }\n\n    return {\n      r: r * 255,\n      g: g * 255,\n      b: b * 255\n    }\n  }\n\n  /**\n   * Converts a XYZ color value to the CIELAB color space. Formulas are based on http://en.wikipedia.org/wiki/Lab_color_space The reference white point used in the conversion is D65.\n   * Assumes x, y and z values are whatever they are and returns L*, a* and b* values\n   *\n   * @static\n   * @param { Number } x The X value\n   * @param { Number } y The Y value\n   * @param { Number } z The Z value\n   * @returns { Object } The Lab representation\n   * @memberof Convert\n   */\n  static xyzToLab (x, y, z) {\n    if (typeof x === 'object') {\n      y = x.y\n      z = x.z\n      x = x.x\n    }\n\n    const whiteX = 95.047\n    const whiteY = 100.0\n    const whiteZ = 108.883\n\n    x /= whiteX\n    y /= whiteY\n    z /= whiteZ\n\n    if (x > 0.008856451679) {\n      x = Math.pow(x, 0.3333333333)\n    } else {\n      x = (7.787037037 * x) + 0.1379310345\n    }\n\n    if (y > 0.008856451679) {\n      y = Math.pow(y, 0.3333333333)\n    } else {\n      y = (7.787037037 * y) + 0.1379310345\n    }\n\n    if (z > 0.008856451679) {\n      z = Math.pow(z, 0.3333333333)\n    } else {\n      z = (7.787037037 * z) + 0.1379310345\n    }\n\n    const l = 116 * y - 16\n    const a = 500 * (x - y)\n    const b = 200 * (y - z)\n\n    return { l, a, b }\n  }\n\n  /**\n   * Converts a L*, a*, b* color values from the CIELAB color space to the XYZ color space. Formulas are based on http://en.wikipedia.org/wiki/Lab_color_space The reference white point used in the conversion is D65.\n   * Assumes L*, a* and b* values are whatever they are and returns x, y and z values.\n   *\n   * @static\n   * @param {*} l The L* value\n   * @param {*} a The a* value\n   * @param {*} b The b* value\n   * @returns  { Object } The XYZ representation\n   * @memberof Convert\n   */\n  static labToXYZ (l, a, b) {\n    if (typeof l === 'object') {\n      a = l.a\n      b = l.b\n      l = l.l\n    }\n\n    let y = (l + 16) / 116\n    let x = y + (a / 500)\n    let z = y - (b / 200)\n\n    if (x > 0.2068965517) {\n      x = x * x * x\n    } else {\n      x = 0.1284185493 * (x - 0.1379310345)\n    }\n    if (y > 0.2068965517) {\n      y = y * y * y\n    } else {\n      y = 0.1284185493 * (y - 0.1379310345)\n    }\n    if (z > 0.2068965517) {\n      z = z * z * z\n    } else {\n      z = 0.1284185493 * (z - 0.1379310345)\n    }\n\n    // D65 reference white point\n    return {\n      x: x * 95.047,\n      y: y * 100.0,\n      z: z * 108.883\n    }\n  }\n\n  /**\n   * Converts L*, a*, b* back to RGB values.\n   * @see Convert.rgbToXYZ\n   * @see Convert.xyzToLab\n   *\n   * @static\n   * @param {*} r The red color value\n   * @param {*} g The green color value\n   * @param {*} b The blue color value\n   * @memberof Convert\n   */\n  static rgbToLab (r, g, b) {\n    if (typeof r === 'object') {\n      g = r.g\n      b = r.b\n      r = r.r\n    }\n\n    const xyz = this.rgbToXYZ(r, g, b)\n    return this.xyzToLab(xyz)\n  }\n}\n","/**\n * Various math-heavy helpers that are used throughout CamanJS.\n *\n * @export\n * @class Calculate\n */\nexport default class Calculate {\n  /**\n   * Calculates the distance between two points.\n   *\n   * @static\n   * @param { Number } x1 1st point x-coordinate.\n   * @param { Number } y1 1st point y-coordinate.\n   * @param { Number } x2 2nd point x-coordinate.\n   * @param { Number } y2 2nd point y-coordinate.\n   * @returns { Number } The distance between the two points.\n   * @memberof Calculate\n   */\n  static distance (x1, y1, x2, y2) {\n    return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2))\n  }\n\n  /**\n   * Generates a pseudorandom number that lies within the max - mix range. The number can be either an integer or a float depending on what the user specifies.\n   *\n   * @static\n   * @param { Number } min The lower bound (inclusive).\n   * @param { Number } max The upper bound (inclusive).\n   * @param { Boolean } getFloat Return a Float or a rounded Integer?\n   * @returns { Number } The pseudorandom number, either as a float or integer.\n   * @memberof Calculate\n   */\n  static randomRange (min, max, getFloat = false) {\n    const rand = min + (Math.random() * (max - min))\n    if (getFloat) {\n      return rand.toFixed(getFloat)\n    } else {\n      return Math.round(rand)\n    }\n  }\n\n  /**\n   * Calculates the luminance of a single pixel using a special weighted sum.\n   *\n   * @static\n   * @param { Object } rgba RGBA object describing a single pixel.\n   * @returns { Number } The luminance value of the pixel.\n   * @memberof Calculate\n   */\n  static luminance (rgba) {\n    return (0.299 * rgba.r) + (0.587 * rgba.g) + (0.114 * rgba.b)\n  }\n\n  /**\n   * Generates a bezier curve given a start and end point, with control points in between.\n   * Can also optionally bound the y values between a low and high bound.\n   * This is different than most bezier curve functions because it attempts to construct it in such a way that we can use it more like a simple input -> output system, or a one-to-one function.\n   * In other words we can provide an input color value, and immediately receive an output modified color value.\n   * Note that, by design, this does not force X values to be in the range [0..255]. This is to generalize the function a bit more. If you give it a starting X value that isn't 0, and/or a ending X value that isn't 255, you may run into problems with your filter!\n   *\n   *\n   * @static\n   * @param { Array } controlPoints 2-item arrays describing the x, y coordinates of the control points. Minimum two.\n   * @param { Number } [lowBound=0] Minimum possible value for any y-value in the curve.\n   * @param { Number } [highBound=255] Maximum possible value for any y-value in the curve.\n   * @returns { Array } Array whose index represents every x-value between start and end, and value represents the corresponding y-value.\n   * @memberof Calculate\n   */\n  static bezier (controlPoints, lowBound = 0, highBound = 255) {\n    if (controlPoints.length < 2) {\n      throw new Error('Invalid number of arguments to bezier')\n    }\n\n    let bezier = {}\n    const lerp = (a, b, t) => a * (1 - t) + b * t\n    const clamp = (a, min, max) => Math.min(Math.max(a, min), max)\n\n    for (let i = 0; i < 1000; i++) {\n      let t = i / 1000\n      let prev = controlPoints\n\n      while (prev.length > 1) {\n        const next = []\n        for (let j = 0; j <= prev.length - 2; j++) {\n          next.push([\n            lerp(prev[j][0], prev[j + 1][0], t),\n            lerp(prev[j][1], prev[j + 1][1], t)\n          ])\n        }\n        prev = next\n      }\n\n      bezier[Math.round(prev[0][0])] = Math.round(clamp(prev[0][1], lowBound, highBound))\n    }\n\n    const endX = controlPoints[controlPoints.length - 1][0]\n    bezier = Calculate.missingValues(bezier, endX)\n\n    // Edge case\n    if (!bezier[endX]) {\n      bezier[endX] = bezier[endX - 1]\n    }\n\n    return bezier\n  }\n\n  /**\n   * Calculates possible missing values from a given value array. Note that this returns a copy and does not mutate the original. In case no values are missing the original array is returned as that is convenient.\n   *\n   * @static\n   * @param { Array } 2-item arrays describing the x, y coordinates of the control points.\n   * @param { Number } end x value of the array (maximum)\n   * @return { Array } Array whose index represents every x-value between start and end, and value represents the corresponding y-value.\n   * @memberof Calculate\n   */\n  static missingValues (values, endX) {\n    // Do a search for missing values in the bezier array and use linear\n    // interpolation to approximate their values\n    if (Object.keys(values).length < endX + 1) {\n      const ret = {}\n      let leftCoord, rightCoord\n      for (let i = 0; i <= endX; i++) {\n        if (values[i]) {\n          ret[i] = values[i]\n        } else {\n          leftCoord = [i - 1, ret[i - 1]]\n          // Find the first value to the right. Ideally this loop will break\n          // very quickly.\n          for (let j = i; j <= endX; j++) {\n            if (values[j]) {\n              rightCoord = [j, values[j]]\n              break\n            }\n          }\n          ret[i] = leftCoord[1] + ((rightCoord[1] - leftCoord[1]) / (rightCoord[0] - leftCoord[0])) * (i - leftCoord[0])\n        }\n      }\n      return ret\n    }\n    return values\n  }\n}\n","// The filters define all of the built-in functionality that comes with Caman (as opposed to being  provided by a plugin). All of these filters are ratherbasic, but are extremely powerful when many are combined. For information on creating plugins, check out the [Plugin Creation](http://camanjs.com/docs/plugin-creation) page, and for information on using the plugins, check out the [Built-In Functionality(http://camanjs.com/docs/built-in) page.\n\nimport Convert from '../core/convert'\nimport Calculate from '../core/calculate'\n\n/**\n *\n *\n * @export\n * @param {*} Filter\n */\nexport default function registerFilter (Filter) {\n  /*\n  * Fill Color\n  * Fills the canvas with a single solid color.\n  * Arguments: Can take either separate R, G, and B values as arguments, or a single hex color value.\n  */\n  Filter.register('fillColor', function (...args) {\n    let color\n    if (args.length === 1) {\n      color = Convert.hexToRGB(args[0])\n    } else {\n      color = {\n        r: args[0],\n        g: args[1],\n        b: args[2]\n      }\n    }\n    this.process('fillColor', (rgba) => {\n      rgba.r = color.r\n      rgba.g = color.g\n      rgba.b = color.b\n      rgba.a = 255\n      return rgba\n    })\n  })\n\n  /*\n  * Brightness\n  * Simple brightness adjustment.\n  * Arguments: Range is -100 to 100. Values < 0 will darken image while values > 0 will brighten.\n  */\n  Filter.register('brightness', function (adjust) {\n    adjust = Math.floor(255 * (adjust / 100))\n    this.process('brightness', (rgba) => {\n      rgba.r += adjust\n      rgba.g += adjust\n      rgba.b += adjust\n      return rgba\n    })\n  })\n\n  /*\n  * Saturation\n  * Adjusts the color saturation of the image.\n  * Arguments: Range is -100 to 100. Values < 0 will desaturate the image while values > 0 will saturate it.\n  * If you want to completely desaturate the image, using the greyscale filter is highly recommended because it will yield better results.\n  */\n  Filter.register('saturation', function (adjust) {\n    adjust *= -0.01\n    this.process('saturation', (rgba) => {\n      const max = Math.max(rgba.r, rgba.g, rgba.b)\n\n      if (rgba.r !== max) {\n        rgba.r += (max - rgba.r) * adjust\n      }\n      if (rgba.g !== max) {\n        rgba.g += (max - rgba.g) * adjust\n      }\n      if (rgba.b !== max) {\n        rgba.b += (max - rgba.b) * adjust\n      }\n\n      return rgba\n    })\n  })\n\n  /*\n  * Vibrance\n  * Similar to saturation, but adjusts the saturation levels in a slightly smarter, more subtle way.\n  * Vibrance will attempt to boost colors that are less saturated more and boost already saturated colors less, while saturation boosts all colors by the same level.\n  * Arguments: Range is -100 to 100. Values < 0 will desaturate the image while values > 0 will saturate it.\n  * If you want to completely desaturate the image, using the greyscale filter is highly recommended because it will yield better results.\n  */\n  Filter.register('vibrance', function (adjust) {\n    adjust *= -1\n    this.process('vibrance', (rgba) => {\n      const max = Math.max(rgba.r, rgba.g, rgba.b)\n      const avg = (rgba.r + rgba.g + rgba.b) / 3\n      const amt = ((Math.abs(max - avg) * 2 / 255) * adjust) / 100\n\n      if (rgba.r !== max) {\n        rgba.r += (max - rgba.r) * amt\n      }\n      if (rgba.g !== max) {\n        rgba.g += (max - rgba.g) * amt\n      }\n      if (rgba.b !== max) {\n        rgba.b += (max - rgba.b) * amt\n      }\n\n      return rgba\n    })\n  })\n\n  /*\n  * Greyscale\n  * An improved greyscale function that should make prettier results than simply using the saturation filter to remove color. It does so by using factors that directly relate to how the human eye perceves color and values. There are no arguments, it simply makes the image greyscale with no in-between.\n  * Algorithm adopted from http://www.phpied.com/image-fun/\n  */\n  Filter.register('greyscale', function () {\n    this.process('greyscale', (rgba) => {\n      const avg = Calculate.luminance(rgba)\n      rgba.r = avg\n      rgba.g = avg\n      rgba.b = avg\n      return rgba\n    })\n  })\n\n  /*\n  * Contrast\n  * Increases or decreases the color contrast of the image.\n  * Arguments: Range is -100 to 100. Values < 0 will decrease contrast while values > 0 will increase contrast.\n  * The contrast adjustment values are a bit sensitive. While unrestricted, sane adjustment values are usually around 5-10.\n  */\n  Filter.register('contrast', function(adjust) {\n    adjust = Math.pow((adjust + 100) / 100, 2)\n    this.process('contrast', (rgba) => {\n      // Red channel\n      rgba.r /= 255\n      rgba.r -= 0.5\n      rgba.r *= adjust\n      rgba.r += 0.5\n      rgba.r *= 255\n\n      // Green channel\n      rgba.g /= 255\n      rgba.g -= 0.5\n      rgba.g *= adjust\n      rgba.g += 0.5\n      rgba.g *= 255\n\n      // Blue channel\n      rgba.b /= 255\n      rgba.b -= 0.5\n      rgba.b *= adjust\n      rgba.b += 0.5\n      rgba.b *= 255\n\n      return rgba\n    })\n  })\n\n  /*\n  * Hue\n  * Adjusts the hue of the image. It can be used to shift the colors in an image in a uniform fashion. If you are unfamiliar with Hue, I recommend reading this [Wikipedia article](http://en.wikipedia.org/wiki/Hue).\n  * Arguments: Range is 0 to 100\n  * Sometimes, Hue is expressed in the range of 0 to 360. If that's the terminology you're used to, think of 0 to 100 representing the percentage of Hue shift in the 0 to 360 range.\n  */\n  Filter.register('hue', function (adjust) {\n    this.process('hue', (rgba) => {\n      const hsv = Convert.rgbToHSV(rgba.r, rgba.g, rgba.b)\n\n      let h = hsv.h * 100\n      h += Math.abs(adjust)\n      h = h % 100\n      h /= 100\n      hsv.h = h\n\n      const {r, g, b} = Convert.hsvToRGB(hsv.h, hsv.s, hsv.v)\n      rgba.r = r\n      rgba.g = g\n      rgba.b = b\n\n      return rgba\n    })\n  })\n\n  /*\n  * Colorize\n  * Uniformly shifts the colors in an image towards the given color. The adjustment range is from 0 to 100. The higher the value, the closer the colors in the image shift towards the given adjustment color.\n  * Arguments: This filter is polymorphic and can take two different sets of arguments. Either a hex color string and an adjustment value, or RGB colors and an adjustment value.\n  */\n  Filter.register('colorize', function (...args) {\n    let rgb, level\n    if (args.length === 2) {\n      rgb = Convert.hexToRGB(args[0])\n      level = args[1]\n    } else if (args.length === 4) {\n      rgb = {\n        r: args[0],\n        g: args[1],\n        b: args[2]\n      }\n      level = args[3]\n    }\n\n    this.process('colorize', (rgba) => {\n      rgba.r -= (rgba.r - rgb.r) * (level / 100)\n      rgba.g -= (rgba.g - rgb.g) * (level / 100)\n      rgba.b -= (rgba.b - rgb.b) * (level / 100)\n      return rgba\n    })\n  })\n\n  /*\n  * Invert\n  * Inverts all colors in the image by subtracting each color channel value from 255. No arguments.\n  */\n  Filter.register('invert', function () {\n    this.process('invert', (rgba) => {\n      rgba.r = 255 - rgba.r\n      rgba.g = 255 - rgba.g\n      rgba.b = 255 - rgba.b\n      return rgba\n    })\n  })\n\n  /*\n  * Sepia\n  * Applies an adjustable sepia filter to the image.\n  * Arguments: Assumes adjustment is between 0 and 100, which represents how much the sepia filter is applied.\n  */\n  Filter.register('sepia', function (adjust = 100) {\n    adjust /= 100\n    this.process('sepia', (rgba) => {\n      // All three color channels have special conversion factors that\n      // define what sepia is. Here we adjust each channel individually,\n      // with the twist that you can partially apply the sepia filter.\n      rgba.r = Math.min(255, (rgba.r * (1 - (0.607 * adjust))) + (rgba.g * (0.769 * adjust)) + (rgba.b * (0.189 * adjust)))\n      rgba.g = Math.min(255, (rgba.r * (0.349 * adjust)) + (rgba.g * (1 - (0.314 * adjust))) + (rgba.b * (0.168 * adjust)))\n      rgba.b = Math.min(255, (rgba.r * (0.272 * adjust)) + (rgba.g * (0.534 * adjust)) + (rgba.b * (1 - (0.869 * adjust))))\n      return rgba\n    })\n  })\n\n  /*\n  * Gamma\n  * Adjusts the gamma of the image.\n  * Arguments: Range is from 0 to infinity, although sane values are from 0 to 4 or 5.\n  * Values between 0 and 1 will lessen the contrast while values greater than 1 will increase it.\n  */\n  Filter.register('gamma', function (adjust) {\n    this.process('gamma', (rgba) => {\n      rgba.r = Math.pow(rgba.r / 255, adjust) * 255\n      rgba.g = Math.pow(rgba.g / 255, adjust) * 255\n      rgba.b = Math.pow(rgba.b / 255, adjust) * 255\n      return rgba\n    })\n  })\n\n  /*\n  * Noise\n  * Adds noise to the image on a scale from 1 - 100. However, the scale isn't constrained, so you can specify a value > 100 if you want a LOT of noise.\n  */\n  Filter.register('noise', function (adjust) {\n    adjust = Math.abs(adjust) * 2.55\n\n    this.process('noise', (rgba) => {\n      const rand = Calculate.randomRange(adjust * -1, adjust)\n      rgba.r += rand\n      rgba.g += rand\n      rgba.b += rand\n      return rgba\n    })\n  })\n\n  /*\n  * Clip\n  * Clips a color to max values when it falls outside of the specified range.\n  * Arguments: supplied value should be between 0 and 100.\n  */\n  Filter.register('clip', function (adjust) {\n    adjust = Math.abs(adjust) * 2.55\n\n    this.process('clip', (rgba) => {\n      if (rgba.r > 255 - adjust) {\n        rgba.r = 255\n      } else if (rgba.r < adjust) {\n        rgba.r = 0\n      }\n\n      if (rgba.g > 255 - adjust) {\n        rgba.g = 255\n      } else if (rgba.g < adjust) {\n        rgba.g = 0\n      }\n\n      if (rgba.b > 255 - adjust) {\n        rgba.b = 255\n      } else if (rgba.b < adjust) {\n        rgba.b = 0\n      }\n\n      return rgba\n    })\n  })\n\n  /*\n  * Channels\n  * Lets you modify the intensity of any combination of red, green, or blue channels individually.\n  * Arguments: Must be given at least one color channel to adjust in order to work.\n  * Options format (must specify 1 - 3 colors):\n  * {\n  *   red: 20,\n  *   green: -5,\n  *   blue: -40\n  * }\n  */\n  Filter.register('channels', function (options) {\n    if (typeof options !== 'object') {\n      return this\n    }\n    for (let chan in options) {\n      if (options.hasOwnProperty(chan)) {\n        if (options[chan] === 0) {\n          delete options[chan]\n          continue\n        }\n        options[chan] /= 100\n      }\n    }\n    if (options.length === 0) {\n      return this\n    }\n\n    this.process('channels', (rgba) => {\n      if (options.red) {\n        if (options.red > 0) {\n          rgba.r += (255 - rgba.r) * options.red\n        } else {\n          rgba.r -= rgba.r * Math.abs(options.red)\n        }\n      }\n      if (options.green) {\n        if (options.green > 0) {\n          rgba.g += (255 - rgba.g) * options.green\n        } else {\n          rgba.g -= rgba.g * Math.abs(options.green)\n        }\n      }\n      if (options.blue) {\n        if (options.blue > 0) {\n          rgba.b += (255 - rgba.b) * options.blue\n        } else {\n          rgba.b -= rgba.b * Math.abs(options.blue)\n        }\n      }\n\n      return rgba\n    })\n  })\n\n  /*\n  * Curves\n  * Curves implementation using Bezier curve equation. If you're familiar with the Curves functionality in Photoshop, this works in a very similar fashion.\n  * Arguments:\n  * chan - [r, g, b, rgb]\n  * cps - [x, y]* (curve control points, min. 2; 0 - 255)\n  * algo - function (optional)\n  *\n  * The first argument represents the channels you wish to modify with the filter. It can be an array of channels or a string (for a single channel). The rest of the arguments are 2-element arrays that represent point coordinates. They are specified in the same order as shown in this image to the right. The coordinates are in the range of 0 to 255 for both X and Y values.\n  * It is possible to pass the function an optional function describing which curve algorithm to use.\n  * It defaults to bezier.\n  * The x-axis represents the input value for a single channel, while the y-axis represents the output value.\n  */\n  Filter.register('curves', function (chans, ...cps) {\n    const last = cps[cps.length - 1]\n    let algo\n    if (typeof last === 'function') {\n      algo = last\n      cps.pop()\n    } else if (typeof last === 'string') {\n      algo = Calculate[last]\n      cps.pop()\n    } else {\n      algo = Calculate.bezier\n    }\n\n    // If channels are in a string, split to an array\n    if (typeof chans === 'string') {\n      chans = chans.split('')\n    }\n    if (chans[0] === 'v') {\n      chans = ['r', 'g', 'b']\n    }\n\n    if (cps.length < 2) {\n      // might want to give a warning now\n      throw new Error('Invalid number of arguments to curves filter')\n    }\n\n    // Generate a curve\n    const bezier = algo(cps, 0, 255)\n\n    // If the curve starts after x = 0, initialize it with a flat line\n    // until the curve begins.\n    const start = cps[0]\n    if (start[0] > 0) {\n      for (let i = 0; i < start[0]; i++) {\n        bezier[i] = start[1]\n      }\n    }\n\n    const end = cps[cps.length - 1]\n    if (end[0] < 255) {\n      for (let i = end[0]; i <= 255; i++) {\n        bezier[i] = end[1]\n      }\n    }\n\n    this.process('curves', (rgba) => {\n      // Now that we have the bezier curve, we do a basic hashmap lookup\n      // to find and replace color values.\n      for (let i = 0; i < chans.length; i++) {\n        rgba[chans[i]] = bezier[rgba[chans[i]]]\n      }\n      return rgba\n    })\n  })\n\n  /*\n  * Exposure\n  * Adjusts the exposure of the image by using the curves function.\n  * Arguments: Range is -100 to 100. Values < 0 will decrease exposure while values > 0 will increase exposure.\n  */\n  Filter.register('exposure', function (adjust) {\n    const p = Math.abs(adjust) / 100\n\n    let ctrl1 = [0, 255 * p]\n    let ctrl2 = [255 - (255 * p), 255]\n\n    if (adjust < 0) {\n      ctrl1 = ctrl1.reverse()\n      ctrl2 = ctrl2.reverse()\n    }\n    this.curves('rgb', [0, 0], ctrl1, ctrl2, [255, 255])\n  })\n}\n","import Calculate from '../core/calculate'\nimport { Util } from '../core/util'\nimport Convert from '../core/convert'\n\nconst vignetteFilters = {\n  brightness (rgba, amt, opts) {\n    rgba.r = rgba.r - (rgba.r * amt * opts.strength)\n    rgba.g = rgba.g - (rgba.g * amt * opts.strength)\n    rgba.b = rgba.b - (rgba.b * amt * opts.strength)\n    return rgba\n  },\n  gamma (rgba, amt, opts) {\n    rgba.r = Math.pow(rgba.r / 255, Math.max(10 * amt * opts.strength, 1)) * 255\n    rgba.g = Math.pow(rgba.g / 255, Math.max(10 * amt * opts.strength, 1)) * 255\n    rgba.b = Math.pow(rgba.b / 255, Math.max(10 * amt * opts.strength, 1)) * 255\n    return rgba\n  },\n  colorize (rgba, amt, opts) {\n    rgba.r -= (rgba.r - opts.color.r) * amt\n    rgba.g -= (rgba.g - opts.color.g) * amt\n    rgba.b -= (rgba.b - opts.color.b) * amt\n    return rgba\n  }\n}\n\n/**\n *\n *\n * @export\n * @param {*} Filter\n */\nexport default function registerCameraFilter (Filter) {\n  Filter.register('vignette', function (size, strength = 60) {\n    let bezier, center, end, start\n\n    if (typeof size === 'string' && size.substr(-1) === '%') {\n      if (this.dimensions.height > this.dimensions.width) {\n        size = this.dimensions.width * (parseInt(size.substr(0, size.length - 1), 10) / 100)\n      } else {\n        size = this.dimensions.height * (parseInt(size.substr(0, size.length - 1), 10) / 100)\n      }\n    }\n    strength /= 100\n    center = [this.dimensions.width / 2, this.dimensions.height / 2]\n    start = Math.sqrt(Math.pow(center[0], 2) + Math.pow(center[1], 2))\n    end = start - size\n    bezier = Calculate.bezier([0, 1], [30, 30], [70, 60], [100, 80])\n    this.process('vignette', function (rgba) {\n      var dist, div, loc\n      loc = rgba.locationXY()\n      dist = Calculate.distance(loc.x, loc.y, center[0], center[1])\n      if (dist > end) {\n        div = Math.max(1, (bezier[Math.round(((dist - end) / size) * 100)] / 10) * strength)\n        rgba.r = Math.pow(rgba.r / 255, div) * 255\n        rgba.g = Math.pow(rgba.g / 255, div) * 255\n        rgba.b = Math.pow(rgba.b / 255, div) * 255\n      }\n      return rgba\n    })\n  })\n\n  Filter.register('rectangularVignette', function (opts) {\n    let defaults, dim, percent, size, _i, _len, _ref\n    defaults = {\n      strength: 50,\n      cornerRadius: 0,\n      method: 'brightness',\n      color: {\n        r: 0,\n        g: 0,\n        b: 0\n      }\n    }\n    opts = Util.extend(defaults, opts)\n    if (!opts.size) {\n      return this\n    } else if (typeof opts.size === 'string') {\n      percent = parseInt(opts.size, 10) / 100\n      opts.size = {\n        width: this.dimensions.width * percent,\n        height: this.dimensions.height * percent\n      }\n    } else if (typeof opts.size === 'object') {\n      _ref = ['width', 'height']\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        dim = _ref[_i]\n        if (typeof opts.size[dim] === 'string') {\n          opts.size[dim] = this.dimensions[dim] * (parseInt(opts.size[dim], 10) / 100)\n        }\n      }\n    } else if (opts.size === 'number') {\n      size = opts.size\n      opts.size = {\n        width: size,\n        height: size\n      }\n    }\n    if (typeof opts.cornerRadius === 'string') {\n      opts.cornerRadius = (opts.size.width / 2) * (parseInt(opts.cornerRadius, 10) / 100)\n    }\n    opts.strength /= 100\n    opts.size.width = Math.floor(opts.size.width)\n    opts.size.height = Math.floor(opts.size.height)\n    opts.image = {\n      width: this.dimensions.width,\n      height: this.dimensions.height\n    }\n    if (opts.method === 'colorize' && typeof opts.color === 'string') {\n      opts.color = Convert.hexToRGB(opts.color)\n    }\n    opts.coords = {\n      left: (this.dimensions.width - opts.size.width) / 2,\n      right: this.dimensions.width - opts.coords.left,\n      bottom: (this.dimensions.height - opts.size.height) / 2,\n      top: this.dimensions.height - opts.coords.bottom\n    }\n    opts.corners = [\n      {\n        x: opts.coords.left + opts.cornerRadius,\n        y: opts.coords.top - opts.cornerRadius\n      }, {\n        x: opts.coords.right - opts.cornerRadius,\n        y: opts.coords.top - opts.cornerRadius\n      }, {\n        x: opts.coords.right - opts.cornerRadius,\n        y: opts.coords.bottom + opts.cornerRadius\n      }, {\n        x: opts.coords.left + opts.cornerRadius,\n        y: opts.coords.bottom + opts.cornerRadius\n      }\n    ]\n    opts.maxDist = Calculate.distance(0, 0, opts.corners[3].x, opts.corners[3].y) - opts.cornerRadius\n    this.process('rectangularVignette', function (rgba) {\n      var amt, loc, radialDist\n      loc = rgba.locationXY()\n      if ((loc.x > opts.corners[0].x && loc.x < opts.corners[1].x) && (loc.y > opts.coords.bottom && loc.y < opts.coords.top)) {\n        return rgba\n      }\n      if ((loc.x > opts.coords.left && loc.x < opts.coords.right) && (loc.y > opts.corners[3].y && loc.y < opts.corners[2].y)) {\n        return rgba\n      }\n      if (loc.x > opts.corners[0].x && loc.x < opts.corners[1].x && loc.y > opts.coords.top) {\n        amt = (loc.y - opts.coords.top) / opts.maxDist\n      } else if (loc.y > opts.corners[2].y && loc.y < opts.corners[1].y && loc.x > opts.coords.right) {\n        amt = (loc.x - opts.coords.right) / opts.maxDist\n      } else if (loc.x > opts.corners[0].x && loc.x < opts.corners[1].x && loc.y < opts.coords.bottom) {\n        amt = (opts.coords.bottom - loc.y) / opts.maxDist\n      } else if (loc.y > opts.corners[2].y && loc.y < opts.corners[1].y && loc.x < opts.coords.left) {\n        amt = (opts.coords.left - loc.x) / opts.maxDist\n      } else if (loc.x <= opts.corners[0].x && loc.y >= opts.corners[0].y) {\n        radialDist = Calculate.distance(loc.x, loc.y, opts.corners[0].x, opts.corners[0].y)\n        amt = (radialDist - opts.cornerRadius) / opts.maxDist\n      } else if (loc.x >= opts.corners[1].x && loc.y >= opts.corners[1].y) {\n        radialDist = Calculate.distance(loc.x, loc.y, opts.corners[1].x, opts.corners[1].y)\n        amt = (radialDist - opts.cornerRadius) / opts.maxDist\n      } else if (loc.x >= opts.corners[2].x && loc.y <= opts.corers[2].y) {\n        radialDist = Calculate.distance(loc.x, loc.y, opts.corners[2].x, opts.corners[2].y)\n        amt = (radialDist - opts.cornerRadius) / opts.maxDist\n      } else if (loc.x <= opts.corners[3].x && loc.y <= opts.corners[3].y) {\n        radialDist = Calculate.distance(loc.x, loc.y, opts.corners[3].x, opts.corners[3].y)\n        amt = (radialDist - opts.cornerRadius) / opts.maxDist\n      }\n      if (amt < 0) {\n        return rgba\n      }\n      return vignetteFilters[opts.method](rgba, amt, opts)\n    })\n  })\n}\n","export default function registerBlurFilter (Filter) {\n  Filter.register('boxBlur', function () {\n    this.processKernel('Box Blur', [1, 1, 1, 1, 1, 1, 1, 1, 1])\n  })\n\n  Filter.register('heavyRadialBlur', function () {\n    this.processKernel('Heavy Radial Blur', [0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0])\n  })\n\n  Filter.register('gaussianBlur', function () {\n    this.processKernel('Gaussian Blur', [1, 4, 6, 4, 1, 4, 16, 24, 16, 4, 6, 24, 36, 24, 6, 4, 16, 24, 16, 4, 1, 4, 6, 4, 1])\n  })\n\n  Filter.register('motionBlur', function (degrees) {\n    let kernel\n    if (degrees === 0 || degrees === 180) {\n      kernel = [0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0]\n    } else if ((degrees > 0 && degrees < 90) || (degrees > 180 && degrees < 270)) {\n      kernel = [0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0]\n    } else if (degrees === 90 || degrees === 270) {\n      kernel = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\n    } else {\n      kernel = [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]\n    }\n    this.processKernel('Motion Blur', kernel)\n  })\n\n  Filter.register('sharpen', function (amt = 100) {\n    amt /= 100\n    this.processKernel('Sharpen', [0, -amt, 0, -amt, 4 * amt + 1, -amt, 0, -amt, 0])\n  })\n}\n","export default function registerPosterizeFilter (Filter) {\n  Filter.register('posterize', function (adjust) {\n    var numOfAreas, numOfValues\n    numOfAreas = 256 / adjust\n    numOfValues = 255 / (adjust - 1)\n    this.process('posterize', function (rgba) {\n      rgba.r = Math.floor(Math.floor(rgba.r / numOfAreas) * numOfValues)\n      rgba.g = Math.floor(Math.floor(rgba.g / numOfAreas) * numOfValues)\n      rgba.b = Math.floor(Math.floor(rgba.b / numOfAreas) * numOfValues)\n      return rgba\n    })\n  })\n}\n","/**\n * some preset filters\n *\n * @export\n * @param {*} Filter\n */\nexport default function registerPresetFilter (Filter) {\n  Filter.register('vintage', function (vignette = true) {\n    this.greyscale()\n    this.contrast(5)\n    this.noise(3)\n    this.sepia(100)\n    this.channels({red: 8, blue: 2, green: 4})\n    this.gamma(0.87)\n\n    if (vignette) {\n      this.vignette('40%', 30)\n    }\n  })\n\n  Filter.register('lomo', function (vignette = true) {\n    this.brightness(15)\n    this.exposure(15)\n    this.curves('rgb', [0, 0], [200, 0], [155, 255], [255, 255])\n    this.saturation(-20)\n    this.gamma(1.8)\n    if (vignette) {\n      this.vignette('50%', 60)\n    }\n    this.brightness(5)\n  })\n\n  // FIXME:sharpen\n  Filter.register('clarity', function (grey = false) {\n    this.vibrance(20)\n    this.curves('rgb', [5, 0], [130, 150], [190, 220], [250, 255])\n    this.sharpen(15)\n    this.vignette('45%', 20)\n    if (grey) {\n      this.greyscale()\n      this.contrast(4)\n    }\n    return this\n  })\n\n  Filter.register('sinCity', function () {\n    this.contrast(100)\n    this.brightness(15)\n    this.exposure(10)\n    this.posterize(80)\n    this.clip(30)\n    this.greyscale()\n  })\n\n  Filter.register('sunrise', function () {\n    this.exposure(3.5)\n    this.saturation(-5)\n    this.vibrance(50)\n    this.sepia(60)\n    this.colorize('#e87b22', 10)\n    this.channels({\n      red: 8,\n      blue: 8\n    })\n    this.contrast(5)\n    this.gamma(1.2)\n    this.vignette('55%', 25)\n  })\n\n  Filter.register('crossProcess', function () {\n    this.exposure(5)\n    this.colorize('#e87b22', 4)\n    this.sepia(20)\n    this.channels({\n      blue: 8,\n      red: 3\n    })\n    this.curves('b', [0, 0], [100, 150], [180, 180], [255, 255])\n    this.contrast(15)\n    this.vibrance(75)\n    this.gamma(1.6)\n  })\n\n  Filter.register('orangePeel', function () {\n    this.curves('rgb', [0, 0], [100, 50], [140, 200], [255, 255])\n    this.vibrance(-30)\n    this.saturation(-30)\n    this.colorize('#ff9000', 30)\n    this.contrast(-5)\n    this.gamma(1.4)\n  })\n\n  Filter.register('love', function () {\n    this.brightness(5)\n    this.exposure(8)\n    this.contrast(4)\n    this.colorize('#c42007', 30)\n    this.vibrance(50)\n    this.gamma(1.3)\n  })\n\n  Filter.register('grungy', function () {\n    this.gamma(1.5)\n    this.clip(25)\n    this.saturation(-60)\n    this.contrast(5)\n    this.noise(5)\n    this.vignette('50%', 30)\n  })\n  // FIXME:sharpen\n  Filter.register('jarques', function () {\n    this.saturation(-35)\n    this.curves('b', [20, 0], [90, 120], [186, 144], [255, 230])\n    this.curves('r', [0, 0], [144, 90], [138, 120], [255, 255])\n    this.curves('g', [10, 0], [115, 105], [148, 100], [255, 248])\n    this.curves('rgb', [0, 0], [120, 100], [128, 140], [255, 255])\n    this.sharpen(20)\n  })\n\n  Filter.register('pinhole', function () {\n    this.greyscale()\n    this.sepia(10)\n    this.exposure(10)\n    this.contrast(15)\n    this.vignette('60%', 35)\n  })\n\n  Filter.register('oldBoot', function () {\n    this.saturation(-20)\n    this.vibrance(-50)\n    this.gamma(1.1)\n    this.sepia(30)\n    this.channels({\n      red: -10,\n      blue: 5\n    })\n    this.curves('rgb', [0, 0], [80, 50], [128, 230], [255, 255])\n    return this.vignette('60%', 30)\n  })\n\n  Filter.register('glowingSun', function (vignette = true) {\n    this.brightness(10)\n    this.newLayer(function () {\n      this.setBlendingMode('multiply')\n      this.opacity(80)\n      this.copyParent()\n      this.filter.gamma(0.8)\n      this.filter.contrast(50)\n      return this.filter.exposure(10)\n    })\n    this.newLayer(function () {\n      this.setBlendingMode('softLight')\n      this.opacity(80)\n      return this.fillColor('#f49600')\n    })\n    this.exposure(20)\n    this.gamma(0.8)\n    if (vignette) {\n      return this.vignette('45%', 20)\n    }\n  })\n\n  Filter.register('hazyDays', function () {\n    this.gamma(1.2)\n    this.newLayer(function () {\n      this.setBlendingMode('overlay')\n      this.opacity(60)\n      this.copyParent()\n      this.filter.channels({\n        red: 5\n      })\n      this.filter.stackBlur(15)\n    })\n    this.newLayer(function () {\n      this.setBlendingMode('addition')\n      this.opacity(40)\n      this.fillColor('#6899ba')\n    })\n    this.newLayer(function () {\n      this.setBlendingMode('multiply')\n      this.opacity(35)\n      this.copyParent()\n      this.filter.brightness(40)\n      this.filter.vibrance(40)\n      this.filter.exposure(30)\n      this.filter.contrast(15)\n      this.filter.curves('r', [0, 40], [128, 128], [128, 128], [255, 215])\n      this.filter.curves('g', [0, 40], [128, 128], [128, 128], [255, 215])\n      this.filter.curves('b', [0, 40], [128, 128], [128, 128], [255, 215])\n      this.filter.stackBlur(5)\n    })\n    this.curves('r', [20, 0], [128, 158], [128, 128], [235, 255])\n    this.curves('g', [20, 0], [128, 128], [128, 128], [235, 255])\n    this.curves('b', [20, 0], [128, 108], [128, 128], [235, 255])\n    this.vignette('45%', 20)\n  })\n\n  Filter.register('herMajesty', function () {\n    this.brightness(40)\n    this.colorize('#ea1c5d', 10)\n    this.curves('b', [0, 10], [128, 180], [190, 190], [255, 255])\n    this.newLayer(function() {\n      this.setBlendingMode('overlay')\n      this.opacity(50)\n      this.copyParent()\n      this.filter.gamma(0.7)\n      return this.newLayer(function() {\n        this.setBlendingMode('normal')\n        this.opacity(60)\n        return this.fillColor('#ea1c5d')\n      })\n    })\n    this.newLayer(function() {\n      this.setBlendingMode('multiply')\n      this.opacity(60)\n      this.copyParent()\n      this.filter.saturation(50)\n      this.filter.hue(90)\n      return this.filter.contrast(10)\n    })\n    this.gamma(1.4)\n    this.vibrance(-30)\n    this.newLayer(function() {\n      this.opacity(10)\n      return this.fillColor('#e5f0ff')\n    })\n    return this\n  })\n\n  Filter.register('nostalgia', function() {\n    this.saturation(20)\n    this.gamma(1.4)\n    this.greyscale()\n    this.contrast(5)\n    this.sepia(100)\n    this.channels({\n      red: 8,\n      blue: 2,\n      green: 4\n    })\n    this.gamma(0.8)\n    this.contrast(5)\n    this.exposure(10)\n    this.newLayer(function() {\n      this.setBlendingMode('overlay')\n      this.copyParent()\n      this.opacity(55)\n      this.filter.stackBlur(10)\n    })\n    this.vignette('50%', 30)\n  })\n\n  Filter.register('hemingway', function () {\n    this.greyscale()\n    this.contrast(10)\n    this.gamma(0.9)\n    this.newLayer(function () {\n      this.setBlendingMode('multiply')\n      this.opacity(40)\n      this.copyParent()\n      this.filter.exposure(15)\n      this.filter.contrast(15)\n      this.filter.channels({\n        green: 10,\n        red: 5\n      })\n    })\n    this.sepia(30)\n    this.curves('rgb', [0, 10], [120, 90], [180, 200], [235, 255])\n    this.channels({\n      red: 5,\n      green: -2\n    })\n    return this.exposure(15)\n  })\n\n  // FIXME: sharpen\n  Filter.register('concentrate', function () {\n    this.sharpen(40)\n    this.saturation(-50)\n    this.channels({\n      red: 3\n    })\n    this.newLayer(function () {\n      this.setBlendingMode('multiply')\n      this.opacity(80)\n      this.copyParent()\n      this.filter.sharpen(5)\n      this.filter.contrast(50)\n      this.filter.exposure(10)\n      this.filter.channels({\n        blue: 5\n      })\n    })\n    this.brightness(10)\n  })\n}\n","/*\nStackBlur - a fast almost Gaussian Blur For Canvas v0.31 modified for CamanJS\n\nVersion:   0.31\nAuthor:    Mario Klingemann\nContact:   mario@quasimondo.com\nWebsite:  http://www.quasimondo.com/StackBlurForCanvas\nTwitter:  @quasimondo\nModified By: Ryan LeFevre (@meltingice)\n\nIn case you find this class useful - especially in commercial projects -\nI am not totally unhappy for a small donation to my PayPal account\nmario@quasimondo.de\n\nOr support me on flattr:\nhttps://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript\n\nCopyright (c) 2010 Mario Klingemann\n\nPermission is hereby granted, free of charge, to any person\nobtaining a copy of this software and associated documentation\nfiles (the \"Software\"), to deal in the Software without\nrestriction, including without limitation the rights to use,\ncopy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the\nSoftware is furnished to do so, subject to the following\nconditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\nOF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\nHOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\nWHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\nFROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\nOTHER DEALINGS IN THE SOFTWARE.\n */\n\nlet BlurStack, mulTable, shgTable\nmulTable = [512, 512, 456, 512, 328, 456, 335, 512, 405, 328, 271, 456, 388, 335, 292, 512, 454, 405, 364, 328, 298, 271, 496, 456, 420, 388, 360, 335, 312, 292, 273, 512, 482, 454, 428, 405, 383, 364, 345, 328, 312, 298, 284, 271, 259, 496, 475, 456, 437, 420, 404, 388, 374, 360, 347, 335, 323, 312, 302, 292, 282, 273, 265, 512, 497, 482, 468, 454, 441, 428, 417, 405, 394, 383, 373, 364, 354, 345, 337, 328, 320, 312, 305, 298, 291, 284, 278, 271, 265, 259, 507, 496, 485, 475, 465, 456, 446, 437, 428, 420, 412, 404, 396, 388, 381, 374, 367, 360, 354, 347, 341, 335, 329, 323, 318, 312, 307, 302, 297, 292, 287, 282, 278, 273, 269, 265, 261, 512, 505, 497, 489, 482, 475, 468, 461, 454, 447, 441, 435, 428, 422, 417, 411, 405, 399, 394, 389, 383, 378, 373, 368, 364, 359, 354, 350, 345, 341, 337, 332, 328, 324, 320, 316, 312, 309, 305, 301, 298, 294, 291, 287, 284, 281, 278, 274, 271, 268, 265, 262, 259, 257, 507, 501, 496, 491, 485, 480, 475, 470, 465, 460, 456, 451, 446, 442, 437, 433, 428, 424, 420, 416, 412, 408, 404, 400, 396, 392, 388, 385, 381, 377, 374, 370, 367, 363, 360, 357, 354, 350, 347, 344, 341, 338, 335, 332, 329, 326, 323, 320, 318, 315, 312, 310, 307, 304, 302, 299, 297, 294, 292, 289, 287, 285, 282, 280, 278, 275, 273, 271, 269, 267, 265, 263, 261, 259]\nshgTable = [9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24]\nBlurStack = function () {\n  this.r = 0\n  this.g = 0\n  this.b = 0\n  this.a = 0\n  this.next = null\n}\n\nexport function registerStackBlurPlugin (Plugin) {\n  Plugin.register('stackBlur', function(radius) {\n    let bInSum, bOutSum, bSum, div, gInSum, gOutSum, gSum, height, heightMinus1, i, mulSum, p, pb, pg, pixels, pr, rInSum, rOutSum, rSum, radiusPlus1, rbs, shgSum, stack, stackEnd, stackIn, stackOut, stackStart, sumFactor, width, widthMinus1, x, y, yi, yp, yw, _i, _j, _k, _l, _m, _n, _o, _p, _q\n    if (isNaN(radius) || radius < 1) {\n      return\n    }\n    radius |= 0\n    pixels = this.pixelData\n    width = this.dimensions.width\n    height = this.dimensions.height\n    div = radius + radius + 1\n    widthMinus1 = width - 1\n    heightMinus1 = height - 1\n    radiusPlus1 = radius + 1\n    sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2\n    stackStart = new BlurStack()\n    stack = stackStart\n    for (i = _i = 1; div >= 1 ? _i < div : _i > div; i = div >= 1 ? ++_i : --_i) {\n      stack = stack.next = new BlurStack()\n      if (i === radiusPlus1) {\n        stackEnd = stack\n      }\n    }\n    stack.next = stackStart\n    stackIn = null\n    stackOut = null\n    yw = yi = 0\n    mulSum = mulTable[radius]\n    shgSum = shgTable[radius]\n    for (y = _j = 0; height >= 0 ? _j < height : _j > height; y = height >= 0 ? ++_j : --_j) {\n      rInSum = gInSum = bInSum = rSum = gSum = bSum = 0\n      rOutSum = radiusPlus1 * (pr = pixels[yi])\n      gOutSum = radiusPlus1 * (pg = pixels[yi + 1])\n      bOutSum = radiusPlus1 * (pb = pixels[yi + 2])\n      rSum += sumFactor * pr\n      gSum += sumFactor * pg\n      bSum += sumFactor * pb\n      stack = stackStart\n      for (i = _k = 0; radiusPlus1 >= 0 ? _k < radiusPlus1 : _k > radiusPlus1; i = radiusPlus1 >= 0 ? ++_k : --_k) {\n        stack.r = pr\n        stack.g = pg\n        stack.b = pb\n        stack = stack.next\n      }\n      for (i = _l = 1; radiusPlus1 >= 1 ? _l < radiusPlus1 : _l > radiusPlus1; i = radiusPlus1 >= 1 ? ++_l : --_l) {\n        p = yi + ((widthMinus1 < i ? widthMinus1 : i) << 2)\n        rSum += (stack.r = (pr = pixels[p])) * (rbs = radiusPlus1 - i)\n        gSum += (stack.g = (pg = pixels[p + 1])) * rbs\n        bSum += (stack.b = (pb = pixels[p + 2])) * rbs\n        rInSum += pr\n        gInSum += pg\n        bInSum += pb\n        stack = stack.next\n      }\n      stackIn = stackStart\n      stackOut = stackEnd\n      for (x = _m = 0; width >= 0 ? _m < width : _m > width; x = width >= 0 ? ++_m : --_m) {\n        pixels[yi] = (rSum * mulSum) >> shgSum\n        pixels[yi + 1] = (gSum * mulSum) >> shgSum\n        pixels[yi + 2] = (bSum * mulSum) >> shgSum\n        rSum -= rOutSum\n        gSum -= gOutSum\n        bSum -= bOutSum\n        rOutSum -= stackIn.r\n        gOutSum -= stackIn.g\n        bOutSum -= stackIn.b\n        p = (yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1)) << 2\n        rInSum += (stackIn.r = pixels[p])\n        gInSum += (stackIn.g = pixels[p + 1])\n        bInSum += (stackIn.b = pixels[p + 2])\n        rSum += rInSum\n        gSum += gInSum\n        bSum += bInSum\n        stackIn = stackIn.next\n        rOutSum += (pr = stackOut.r)\n        gOutSum += (pg = stackOut.g)\n        bOutSum += (pb = stackOut.b)\n        rInSum -= pr\n        gInSum -= pg\n        bInSum -= pb\n        stackOut = stackOut.next\n        yi += 4\n      }\n      yw += width\n    }\n    for (x = _n = 0; width >= 0 ? _n < width : _n > width; x = width >= 0 ? ++_n : --_n) {\n      gInSum = bInSum = rInSum = gSum = bSum = rSum = 0\n      yi = x << 2\n      rOutSum = radiusPlus1 * (pr = pixels[yi])\n      gOutSum = radiusPlus1 * (pg = pixels[yi + 1])\n      bOutSum = radiusPlus1 * (pb = pixels[yi + 2])\n      rSum += sumFactor * pr\n      gSum += sumFactor * pg\n      bSum += sumFactor * pb\n      stack = stackStart\n      for (i = _o = 0; radiusPlus1 >= 0 ? _o < radiusPlus1 : _o > radiusPlus1; i = radiusPlus1 >= 0 ? ++_o : --_o) {\n        stack.r = pr\n        stack.g = pg\n        stack.b = pb\n        stack = stack.next\n      }\n      yp = width\n      for (i = _p = 1; radius >= 1 ? _p <= radius : _p >= radius; i = radius >= 1 ? ++_p : --_p) {\n        yi = (yp + x) << 2\n        rSum += (stack.r = (pr = pixels[yi])) * (rbs = radiusPlus1 - i)\n        gSum += (stack.g = (pg = pixels[yi + 1])) * rbs\n        bSum += (stack.b = (pb = pixels[yi + 2])) * rbs\n        rInSum += pr\n        gInSum += pg\n        bInSum += pb\n        stack = stack.next\n        if (i < heightMinus1) {\n          yp += width\n        }\n      }\n      yi = x\n      stackIn = stackStart\n      stackOut = stackEnd\n      for (y = _q = 0; height >= 0 ? _q < height : _q > height; y = height >= 0 ? ++_q : --_q) {\n        p = yi << 2\n        pixels[p] = (rSum * mulSum) >> shgSum\n        pixels[p + 1] = (gSum * mulSum) >> shgSum\n        pixels[p + 2] = (bSum * mulSum) >> shgSum\n        rSum -= rOutSum\n        gSum -= gOutSum\n        bSum -= bOutSum\n        rOutSum -= stackIn.r\n        gOutSum -= stackIn.g\n        bOutSum -= stackIn.b\n        p = (x + (((p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width)) << 2\n        rSum += (rInSum += (stackIn.r = pixels[p]))\n        gSum += (gInSum += (stackIn.g = pixels[p + 1]))\n        bSum += (bInSum += (stackIn.b = pixels[p + 2]))\n        stackIn = stackIn.next\n        rOutSum += (pr = stackOut.r)\n        gOutSum += (pg = stackOut.g)\n        bOutSum += (pb = stackOut.b)\n        rInSum -= pr\n        gInSum -= pg\n        bInSum -= pb\n        stackOut = stackOut.next\n        yi += width\n      }\n    }\n    return this\n  })\n}\n\nexport function registerStackBlurFilter (Filter) {\n  Filter.register('stackBlur', function (radius) {\n    this.processPlugin('stackBlur', [radius])\n  })\n}\n","import registerCameraFilter from './camera'\nimport registerBlurFilter from './blur'\nimport registrerPosterizeFilter from './posterize'\nimport registerPresetFilter from './presets'\nimport { registerStackBlurPlugin, registerStackBlurFilter } from './stackBlur'\n\nexport function registerPlugin (Plugin) {\n  registerStackBlurPlugin(Plugin)\n}\n\nexport function registerPluginFilter (Filter) {\n  registerCameraFilter(Filter)\n  registerBlurFilter(Filter)\n  registrerPosterizeFilter(Filter)\n  registerPresetFilter(Filter)\n  registerStackBlurFilter(Filter)\n}\n","import Caman from './caman'\nimport Blender from './blender'\nimport Filter from './filter'\nimport Plugin from './plugin'\n\nimport registerBlender from '../lib/blenders'\nimport registerFilter from '../lib/filters'\nimport { registerPlugin, registerPluginFilter } from '../lib/plugins'\n\n// wechat mini program env\nif (typeof wx === 'undefined') {\n  // throw new Error('Wechat-CamanJS can only run in wechat mini program')\n}\nregisterBlender(Blender)\nregisterFilter(Filter)\n\nregisterPlugin(Plugin)\nregisterPluginFilter(Filter)\n\nexport default Caman\n"],"names":["moduleKeywords","Module","obj","key","indexOf","extended","apply","prototype","included","args","target","pop","i","source","to","from","Object","defineProperty","get","set","val","func","call","$","sel","root","document","exports","querySelector","noop","Util","id","dest","src","copy","prop","hasOwnProperty","opts","attributes","attr","except","nodeName","setAttribute","nodeValue","length","Uint8Array","Array","Store","search","items","name","callback","setTimeout","Analyze","c","levels","r","g","b","j","pixelData","numPixels","Event","type","data","events","event","fn","_type","_fn","types","push","Filter","filterFunc","Caman","Single","Kernel","LayerDequeue","LayerFinished","LoadOverlay","Plugin","Logger","logLevel","DEBUG","console","e","debug","log","Log","plugin","plugins","context","Pixel","x","y","width","loc","Math","floor","a","Error","dimensions","height","horiz","vert","newLoc","pixelAtLocation","coordinatesToLocation","rgba","toKey","includeAlpha","hex","toString","IO","img","corsEnabled","isURLRemote","crossOrigin","toLowerCase","url","matches","match","domainRegex","domain","remoteProxy","info","proxyUrl","proxyParam","encodeURIComponent","lang","langToExt","ruby","python","perl","javascript","Renderer","renderQueue","modPixelData","job","trigger","finishedFn","currentJob","shift","Type","layer","canvasQueue","executeLayer","processNext","applyCurrentLayer","popContext","loadOverlay","executePlugin","executeFilter","dataArray","blocksDone","n","blockPixelLength","Blocks","blockN","lastBlockN","start","end","eachBlock","renderBlock","renderKernel","execute","bnum","blockNum","totalBlocks","startPixel","endPixel","pixel","setContext","processFn","clampRGB","blockFinished","bias","divisor","adjust","adjustSize","sqrt","kernel","max","min","builder","builderIndex","k","p","getPixelRelative","res","processKernel","blocksFinished","Image","onload","drawImage","imageData","getImageData","remoteCheck","Blender","blenders","rgbaLayer","rgbaParent","Layer","filter","options","blendingMode","opacity","layerID","uniqid","canvas","createElement","getContext","createImageData","cb","newLayer","mode","parentData","fillColor","arguments","image","renderer","pixelStack","layerData","result","version","release","date","NodeJS","getAttribute","finishInit","bind","imageLoaded","parseInt","getAttrId","isNaN","has","initializedPixelData","originalPixelData","cropCoordinates","cropped","resized","layerStack","currentLayer","scaled","analyze","domIsLoaded","parseArguments","setup","readyState","listener","addEventListener","initObj","initType","imageUrl","setInitObject","initNode","initImage","initCanvas","copyAttributes","parentNode","replaceChild","imageAdjustments","waitForImageLoaded","isRemote","isImageLoaded","complete","naturalWidth","naturalHeight","imageWidth","imageHeight","originalWidth","preScaledWidth","originalHeight","preScaledHeight","hasId","assignId","allowRevert","put","newCanvas","oldCanvas","reloadCanvasData","putImageData","updateContext","originalVisiblePixels","ctx","replaceCanvas","pixels","add","pushContext","applyToParent","nodeSave","browserSave","toBase64","replace","location","href","window","devicePixelRatio","toDataURL","registerBlender","register","Convert","charAt","substr","l","h","s","d","q","hueToRGB","t","v","f","pow","z","whiteX","whiteY","whiteZ","xyz","rgbToXYZ","xyzToLab","Calculate","x1","y1","x2","y2","getFloat","rand","random","toFixed","round","controlPoints","lowBound","highBound","bezier","lerp","clamp","prev","next","endX","missingValues","values","keys","ret","leftCoord","rightCoord","registerFilter","color","hexToRGB","process","avg","amt","abs","luminance","hsv","rgbToHSV","hsvToRGB","rgb","level","randomRange","chan","red","green","blue","chans","cps","last","algo","split","ctrl1","ctrl2","reverse","curves","vignetteFilters","brightness","strength","gamma","colorize","registerCameraFilter","size","center","dist","div","locationXY","distance","defaults","dim","percent","_i","_len","_ref","cornerRadius","method","extend","babelHelpers.typeof","coords","left","right","bottom","top","corners","maxDist","radialDist","corers","registerBlurFilter","degrees","registerPosterizeFilter","numOfAreas","numOfValues","registerPresetFilter","vignette","greyscale","contrast","noise","sepia","channels","exposure","saturation","grey","vibrance","sharpen","posterize","clip","setBlendingMode","copyParent","stackBlur","hue","BlurStack","mulTable","shgTable","registerStackBlurPlugin","radius","bInSum","bOutSum","bSum","gInSum","gOutSum","gSum","heightMinus1","mulSum","pb","pg","pr","rInSum","rOutSum","rSum","radiusPlus1","rbs","shgSum","stack","stackEnd","stackIn","stackOut","stackStart","sumFactor","widthMinus1","yi","yp","yw","_j","_k","_l","_m","_n","_o","_p","_q","registerStackBlurFilter","processPlugin","registerPlugin","registerPluginFilter","registrerPosterizeFilter"],"mappings":"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"}